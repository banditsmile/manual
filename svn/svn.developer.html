<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>&#31532;&nbsp;8&nbsp;&#31456;&nbsp;&#23884;&#20837;Subversion</title><link rel="stylesheet" href="styles.css"  type="text/css"><meta name="generator" content="DocBook XSL-NS Stylesheets V1.73.2"><link rel="start" href="index.html" title="&#20351;&#29992;Subversion&#36827;&#34892;&#29256;&#26412;&#25511;&#21046;"><link rel="up" href="index.html" title="&#20351;&#29992;Subversion&#36827;&#34892;&#29256;&#26412;&#25511;&#21046;"><link rel="prev" href="svn.advanced.externaldifftools.html" title="Using External Differencing and Merge Tools"><link rel="next" href="svn.developer.insidewc.html" title="&#36827;&#20837;&#24037;&#20316;&#25335;&#36125;&#30340;&#31649;&#29702;&#21306;"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">&#31532;&nbsp;8&nbsp;&#31456;&nbsp;&#23884;&#20837;Subversion</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="svn.advanced.externaldifftools.html" >&#19978;&#19968;&#39029;</a>&nbsp;</td><th width="60%" align="center">&nbsp;</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="svn.developer.insidewc.html" >&#19979;&#19968;&#39029;</a></td></tr></table><hr></div><div class="chapter" lang="zh-cn"><div class="titlepage"><div><div><h1 class="title"><a name="svn.developer"></a>&#23884;&#20837;Subversion</h1></div></div></div><div class="toc"><p><b>&#30446;&#24405;</b></p><dl><dt><span class="section"><a href="svn.developer.html#svn.developer.layerlib" >&#20998;&#23618;&#30340;&#24211;&#35774;&#35745;</a></span></dt><dd><dl><dt><span class="section"><a href="svn.developer.html#svn.developer.layerlib.repos" >&#29256;&#26412;&#24211;&#23618;</a></span></dt><dt><span class="section"><a href="svn.developer.html#svn.developer.layerlib.ra" >&#29256;&#26412;&#24211;&#35775;&#38382;&#23618;</a></span></dt><dt><span class="section"><a href="svn.developer.html#svn.developer.layerlib.client" >&#23458;&#25143;&#31471;&#23618;</a></span></dt></dl></dd><dt><span class="section"><a href="svn.developer.insidewc.html" >&#36827;&#20837;&#24037;&#20316;&#25335;&#36125;&#30340;&#31649;&#29702;&#21306;</a></span></dt><dd><dl><dt><span class="section"><a href="svn.developer.insidewc.html#svn.developer.insidewc.entries" >&#26465;&#30446;&#25991;&#20214;</a></span></dt><dt><span class="section"><a href="svn.developer.insidewc.html#svn.developer.insidewc.base-and-props" >&#21407;&#22987;&#25335;&#36125;&#21644;&#23646;&#24615;&#25991;&#20214;</a></span></dt></dl></dd><dt><span class="section"><a href="svn.developer.usingapi.html" >&#20351;&#29992;API</a></span></dt><dd><dl><dt><span class="section"><a href="svn.developer.usingapi.html#svn.developer.usingapi.apr" >Apache&#21487;&#31227;&#26893;&#36816;&#34892;&#24211;</a></span></dt><dt><span class="section"><a href="svn.developer.usingapi.html#svn.developer.usingapi.urlpath" >URL &#21644;&#36335;&#24452;&#38656;&#27714;</a></span></dt><dt><span class="section"><a href="svn.developer.usingapi.html#svn.developer.usingapi.otherlangs" >&#20351;&#29992; C &#21644; C++ &#20197;&#22806;&#30340;&#35821;&#35328;</a></span></dt><dt><span class="section"><a href="svn.developer.usingapi.html#svn.developer.usingapi.codesamples" >&#20195;&#30721;&#26679;&#20363;</a></span></dt></dl></dd></dl></div><p>Subversion&#26377;&#19968;&#20010;&#27169;&#22359;&#21270;&#30340;&#35774;&#35745;&#65292;&#20197;&#24211;&#30340;&#24418;&#24335;&#30001;C&#32534;&#20889;&#21644;&#23454;&#29616;&#12290;&#27599;&#20010;&#24211;&#37117;&#26377;&#19968;&#20010;&#23450;&#20041;&#33391;&#22909;&#30340;&#30446;&#30340;&#21644;API&#65292;&#32780;&#19988;&#36825;&#20123;&#25509;&#21475;&#19981;&#20165;&#20165;&#20026;&#20102;Subversion&#26412;&#36523;&#20351;&#29992;&#65292;&#20063;&#21487;&#20197;&#20026;&#20219;&#20309;&#24076;&#26395;&#23884;&#20837;&#32534;&#31243;&#26041;&#24335;&#25511;&#21046;Subversion&#30340;&#36719;&#20214;&#12290;&#27492;&#22806;&#65292;Subversion&#30340;API&#19981;&#20165;&#20165;&#21487;&#20197;&#20026;C&#31243;&#24207;&#20351;&#29992;&#65292;&#20063;&#21487;&#20197;&#20351;&#29992;&#22914;Ptyhon&#12289;Perl&#12289;Java&#25110;Ruby&#31561;&#39640;&#32423;&#35821;&#35328;&#35843;&#29992;&#12290;</p><p>&#26412;&#31456;&#26159;&#20026;&#37027;&#20123;&#24076;&#26395;&#32534;&#20889;&#20195;&#30721;&#25110;&#20854;&#20182;&#35821;&#35328;&#32465;&#23450;&#19982;Subversion&#20132;&#20114;&#30340;&#20154;&#20934;&#22791;&#30340;&#12290;&#22914;&#26524;&#20320;&#22260;&#32469;Subversion&#21151;&#33021;&#32534;&#20889;&#20581;&#22766;&#30340;&#33050;&#26412;&#26469;&#31616;&#21270;&#20320;&#30340;&#29983;&#27963;&#65292;&#35774;&#27861;&#24320;&#21457;Subversion&#19982;&#20854;&#20182;&#36719;&#20214;&#30340;&#22797;&#26434;&#38598;&#25104;&#65292;&#25110;&#32773;&#21482;&#26159;&#23545;Subversion&#19981;&#21516;&#24211;&#27169;&#22359;&#25552;&#20379;&#21151;&#33021;&#24863;&#20852;&#36259;&#65292;&#36825;&#19968;&#31456;&#26159;&#20026;&#20320;&#20934;&#22791;&#30340;&#12290;&#28982;&#32780;&#65292;&#22914;&#26524;&#20320;&#19981;&#33021;&#39044;&#35265;&#20320;&#20250;&#20197;&#27492;&#31181;&#31243;&#24230;&#21442;&#19982;Subversion&#65292;&#20320;&#21487;&#20197;&#25918;&#24515;&#30340;&#36339;&#36807;&#26412;&#31456;&#65292;&#30053;&#36807;&#26412;&#31456;&#19981;&#20250;&#24433;&#21709;&#20320;&#23545;Subversion&#20351;&#29992;&#30340;&#20307;&#39564;&#12290;</p><div class="section" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="svn.developer.layerlib"></a>&#20998;&#23618;&#30340;&#24211;&#35774;&#35745;</h2></div></div></div><p>Each of Subversion's core libraries can be said to exist in
      one of three main layers&#8212;the Repository Layer, the
      Repository Access (RA) Layer, or the Client Layer (see <a class="xref" href="svn.intro.whatis.html#svn.intro.architecture.dia-1"  title="&#22270;&nbsp;1.&nbsp;Subversion's architecture">&#22270;&nbsp;1 &#8220;Subversion's architecture&#8221;</a>).  We will examine
      these layers shortly, but first, let's briefly summarize
      Subversion's various libraries.  For the sake of consistency, we
      will refer to the libraries by their extensionless Unix library
      names (<code class="filename">libsvn_fs</code>, <code class="filename">libsvn_wc</code>,
      <code class="filename">mod_dav_svn</code>, etc.).</p><div class="variablelist"><dl><dt><span class="term">libsvn_client</span></dt><dd><p>&#23458;&#25143;&#31471;&#31243;&#24207;&#30340;&#20027;&#35201;&#25509;&#21475;</p></dd><dt><span class="term">libsvn_delta</span></dt><dd><p>&#30446;&#24405;&#26641;&#21644;&#25991;&#26412;&#21306;&#21035;&#31243;&#24207;</p></dd><dt><span class="term">libsvn_diff</span></dt><dd><p>&#19978;&#19979;&#25991;&#21306;&#21035;&#21644;&#21512;&#24182;&#20363;&#31243;</p></dd><dt><span class="term">libsvn_fs</span></dt><dd><p>Subversion&#25991;&#20214;&#31995;&#32479;&#24211;&#21644;&#27169;&#22359;&#21152;&#36733;&#22120;</p></dd><dt><span class="term">libsvn_fs_base</span></dt><dd><p>The Berkeley DB filesystem
          backend</p></dd><dt><span class="term">libsvn_fs_fs</span></dt><dd><p>The native filesystem (FSFS)
          backend</p></dd><dt><span class="term">libsvn_ra</span></dt><dd><p>&#29256;&#26412;&#24211;&#35775;&#38382;&#36890;&#29992;&#32452;&#20214;&#21644;&#27169;&#22359;&#35013;&#36733;&#22120;</p></dd><dt><span class="term">libsvn_ra_neon</span></dt><dd><p>WebDAV&#29256;&#26412;&#24211;&#35775;&#38382;&#27169;&#22359;</p></dd><dt><span class="term">libsvn_ra_local</span></dt><dd><p>&#26412;&#22320;&#29256;&#26412;&#24211;&#35775;&#38382;&#27169;&#22359;</p></dd><dt><span class="term">libsvn_ra_serf</span></dt><dd><p>&#21478;&#19968;&#20010;(&#23454;&#39564;&#24615;&#30340;) WebDAV &#29256;&#26412;&#24211;&#35775;&#38382;&#27169;&#22359;</p></dd><dt><span class="term">libsvn_ra_svn</span></dt><dd><p>&#19968;&#20010;&#33258;&#23450;&#20041;&#29256;&#26412;&#24211;&#35775;&#38382;&#27169;&#22359;</p></dd><dt><span class="term">libsvn_repos</span></dt><dd><p>&#29256;&#26412;&#24211;&#25509;&#21475;</p></dd><dt><span class="term">libsvn_subr</span></dt><dd><p>&#21508;&#33394;&#21508;&#26679;&#30340;&#26377;&#29992;&#30340;&#23376;&#31243;&#24207;</p></dd><dt><span class="term">libsvn_wc</span></dt><dd><p>&#24037;&#20316;&#25335;&#36125;&#31649;&#29702;&#24211;</p></dd><dt><span class="term">mod_authz_svn</span></dt><dd><p>&#20351;&#29992;WebDAV&#35775;&#38382;Subversion&#29256;&#26412;&#24211;&#30340;Apache&#25480;&#26435;&#27169;&#22359;</p></dd><dt><span class="term">mod_dav_svn</span></dt><dd><p>&#24433;&#23556;WebDAV&#25805;&#20316;&#20026;Subversion&#25805;&#20316;&#30340;Apache&#27169;&#22359;</p></dd></dl></div><p>The fact that the word &#8220;<span class="quote">miscellaneous</span>&#8221;
      appears only once in the previous list is a good sign.  The
      Subversion development team is serious about making sure that
      functionality lives in the right layer and libraries.  Perhaps
      the greatest advantage of the modular design is its lack of
      complexity from a developer's point of view.  As a developer,
      you can quickly formulate that kind of &#8220;<span class="quote">big
      picture</span>&#8221; that allows you to pinpoint the location of
      certain pieces of functionality with relative ease.</p><p>Another benefit of modularity is the ability to replace a
      given module with a whole new library that implements the same
      API without affecting the rest of the code base.  In some sense,
      this happens within Subversion already.  The
      <code class="filename">libsvn_ra_neon</code>,
      <code class="filename">libsvn_ra_local</code>,
      <code class="filename">libsvn_ra_serf</code>, and
      <code class="filename">libsvn_ra_svn</code> libraries each implement the
      same interface, all working as plug-ins to
      <code class="filename">libsvn_ra</code>.  And all four communicate with
      the Repository Layer&#8212;libsvn_ra_local connects to the
      repository directly; the other three do so over a network.  The
      <code class="filename">libsvn_fs_base</code> and
      <code class="filename">libsvn_fs_fs</code> libraries are another pair of
      libraries that implement the same functionality in different
      ways&#8212;both are plug-ins to the common
      <code class="filename">libsvn_fs</code> library.</p><p>The client itself also highlights the benefits of modularity
      in the Subversion design.  Subversion's
      <code class="filename">libsvn_client</code> library is a one-stop shop
      for most of the functionality necessary for designing a working
      Subversion client (see <a class="xref" href="svn.developer.html#svn.developer.layerlib.client"  title="&#23458;&#25143;&#31471;&#23618;">&#8220;&#23458;&#25143;&#31471;&#23618;&#8221;&#19968;&#33410;</a>).  So while the
      Subversion distribution provides only the <span class="command"><strong>svn</strong></span>
      command-line client program, there are several third-party
      programs that provide various forms of graphical client UIs.
      These GUIs use the same APIs that the stock command-line client
      does.  This type of modularity has played a large role in the
      proliferation of available Subversion clients and IDE
      integrations and, by extension, to the tremendous adoption rate
      of Subversion itself.</p><div class="section" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="svn.developer.layerlib.repos"></a>&#29256;&#26412;&#24211;&#23618;</h3></div></div></div><p>When referring to Subversion's Repository Layer, we're
        generally talking about two basic concepts&#8212;the versioned
        filesystem implementation (accessed via
        <code class="filename">libsvn_fs</code>, and supported by its
        <code class="filename">libsvn_fs_base</code> and
        <code class="filename">libsvn_fs_fs</code> plug-ins), and the repository
        logic that wraps it (as implemented in
        <code class="filename">libsvn_repos</code>).  These libraries provide
        the storage and reporting mechanisms for the various revisions
        of your version-controlled data.  This layer is connected to
        the Client Layer via the Repository Access Layer, and is, from
        the perspective of the Subversion user, the stuff at the
        &#8220;<span class="quote">other end of the line.</span>&#8221;</p><p>The Subversion Filesystem is not a kernel-level filesystem
        that one would install in an operating system (such as the
        Linux ext2 or NTFS), but instead is a a virtual filesystem.
        Rather than storing &#8220;<span class="quote">files</span>&#8221; and
        &#8220;<span class="quote">directories</span>&#8221; as real files and directories (the
        kind you can navigate through using your favorite shell
        program), it uses one of two available abstract storage
        backends&#8212;either a Berkeley DB database environment or a
        flat-file representation.  (To learn more about the two
        repository backends, see <a class="xref" href="svn.reposadmin.planning.html#svn.reposadmin.basics.backends"  title="&#36873;&#25321;&#25968;&#25454;&#23384;&#20648;&#26684;&#24335;">&#8220;&#36873;&#25321;&#25968;&#25454;&#23384;&#20648;&#26684;&#24335;&#8221;&#19968;&#33410;</a>.)  There has even
        been considerable interest by the development community in
        giving future releases of Subversion the ability to use other
        backend database systems, perhaps through a mechanism such as
        Open Database Connectivity (ODBC).  In fact, Google did
        something similar to this before launching the Google Code
        Project Hosting service:  they announced in mid-2006 that
        members of its open source team had written a new proprietary
        Subversion filesystem plug-in that used their ultra-scalable
        Bigtable database for its storage.</p><p>The filesystem API exported by
        <code class="filename">libsvn_fs</code> contains the kinds of
        functionality you would expect from any other filesystem
        API&#8212;you can create and remove files and directories,
        copy and move them around, modify file contents, and so on.
        It also has features that are not quite as common, such as the
        ability to add, modify, and remove metadata
        (&#8220;<span class="quote">properties</span>&#8221;) on each file or directory.
        Furthermore, the Subversion Filesystem is a versioning
        filesystem, which means that as you make changes to your
        directory tree, Subversion remembers what your tree looked
        like before those changes.  And before the previous changes.
        And the previous ones.  And so on, all the way back through
        versioning time to (and just beyond) the moment you first
        started adding things to the filesystem.</p><p>&#25152;&#26377;&#20320;&#23545;&#30446;&#24405;&#26641;&#30340;&#20462;&#25913;&#21253;&#21547;&#22312;Subversion&#20107;&#21153;&#30340;&#19978;&#19979;&#25991;&#20013;&#65292;&#19979;&#38754;&#25551;&#36848;&#20102;&#20462;&#25913;&#25991;&#20214;&#31995;&#32479;&#30340;&#20363;&#31243;&#65306;</p><div class="orderedlist"><ol type="1"><li><p>&#24320;&#22987; Subversion &#30340;&#25552;&#20132;&#20107;&#21153;&#12290;</p></li><li><p>&#20316;&#20986;&#20462;&#25913;(&#28155;&#21152;&#12289;&#21024;&#38500;&#12289;&#23646;&#24615;&#20462;&#25913;&#31561;&#31561;&#12290;)&#12290;</p></li><li><p>&#25552;&#20132;&#20107;&#21153;&#12290;</p></li></ol></div><p>&#19968;&#26086;&#20320;&#25552;&#20132;&#20102;&#20320;&#30340;&#20107;&#21153;&#65292;&#20320;&#30340;&#25991;&#20214;&#31995;&#32479;&#20462;&#25913;&#23601;&#20250;&#27704;&#20037;&#30340;&#20316;&#20026;&#21382;&#21490;&#20445;&#23384;&#36215;&#26469;&#65292;&#27599;&#20010;&#36825;&#26679;&#30340;&#21608;&#26399;&#20250;&#20135;&#29983;&#19968;&#20010;&#26032;&#30340;&#26641;&#65292;&#25152;&#26377;&#30340;&#20462;&#35746;&#29256;&#26412;&#37117;&#26159;&#27704;&#36828;&#21487;&#20197;&#35775;&#38382;&#30340;&#19968;&#20010;&#19981;&#21464;&#30340;&#24555;&#29031;&#12290;</p><div class="sidebar"><p class="title"><b>&#20107;&#21153;&#30340;&#20854;&#23427;&#20449;&#24687;</b></p><p>The notion of a Subversion transaction can become easily
          confused with the transaction support provided by the
          underlying database itself, especially given the former's
          close proximity to the Berkeley DB database code in
          <code class="filename">libsvn_fs_base</code>.  Both types of
          transaction exist to provide atomicity and isolation.  In
          other words, transactions give you the ability to perform a
          set of actions in an all-or-nothing fashion&#8212;either all
          the actions in the set complete with success, or they all
          get treated as if <span class="emphasis"><em>none</em></span> of them ever
          happened&#8212;and in a way that does not interfere with
          other processes acting on the data.</p><p>Database transactions generally encompass small
          operations related specifically to the modification of data
          in the database itself (such as changing the contents of a
          table row).  Subversion transactions are larger in scope,
          encompassing higher-level operations such as making
          modifications to a set of files and directories that are
          intended to be stored as the next revision of the filesystem
          tree.  If that isn't confusing enough, consider the fact
          that Subversion uses a database transaction during the
          creation of a Subversion transaction (so that if the
          creation of Subversion transaction fails, the database will
          look as if we had never attempted that creation in the first
          place)!</p><p>&#24456;&#24184;&#36816;&#30340;&#26159;&#29992;&#25143;&#30340;&#25991;&#20214;&#31995;&#32479;API&#65292;&#25968;&#25454;&#24211;&#25552;&#20379;&#30340;&#20107;&#21153;&#25903;&#25345;&#26412;&#36523;&#20960;&#20046;&#23436;&#20840;&#20174;&#22806;&#34920;&#38544;&#34255;(&#20063;&#26159;&#19968;&#20010;&#23436;&#20840;&#27169;&#22359;&#21270;&#30340;&#27169;&#24335;&#25152;&#24212;&#35813;&#30340;)&#12290;&#21482;&#26377;&#24403;&#20320;&#24320;&#22987;&#30740;&#31350;&#25991;&#20214;&#31995;&#32479;&#26412;&#36523;&#30340;&#23454;&#29616;&#26102;&#65292;&#36825;&#20123;&#20107;&#24773;&#25165;&#21487;&#35265;(&#25110;&#32773;&#26159;&#24320;&#22987;&#24863;&#20852;&#36259;)&#12290;</p></div><p>Most of the functionality provided by the filesystem
        interface deals with actions that occur on individual
        filesystem paths.  That is, from outside of the filesystem, the
        primary mechanism for describing and accessing the individual
        revisions of files and directories comes through the use of
        path strings such as <code class="filename">/foo/bar</code>, just as if
        you were addressing files and directories through your
        favorite shell program.  You add new files and directories by
        passing their paths-to-be to the right API functions.  You
        query for information about them by the same mechanism.</p><p>Unlike most filesystems, though, a path alone is not
        enough information to identify a file or directory in
        Subversion.  Think of a directory tree as a two-dimensional
        system, where a node's siblings represent a sort of
        left-and-right motion, and navigating into the node's
        subdirectories represents a downward motion.  <a class="xref" href="svn.developer.html#svn.developer.layerlib.repos.dia-1"  title="&#22270;&nbsp;8.1.&nbsp;&#20108;&#32500;&#30340;&#25991;&#20214;&#21644;&#30446;&#24405;">&#22270;&nbsp;8.1 &#8220;&#20108;&#32500;&#30340;&#25991;&#20214;&#21644;&#30446;&#24405;&#8221;</a> shows a typical
        representation of a tree as exactly that.</p><div class="figure"><a name="svn.developer.layerlib.repos.dia-1"></a><p class="title"><b>&#22270;&nbsp;8.1.&nbsp;&#20108;&#32500;&#30340;&#25991;&#20214;&#21644;&#30446;&#24405;</b></p><div class="figure-contents"><div class="mediaobject"><img src="images/ch08dia1.png" ></div></div></div><br class="figure-break"><p>The difference here is that the Subversion filesystem has a
        nifty third dimension that most filesystems do not
        have&#8212;Time!
        <sup>[<a name="d0e15625" href="svn.developer.html#ftn.d0e15625" class="footnote">50</a>]</sup>
        In the filesystem interface, nearly every function that has a
        <em class="parameter"><code>path</code></em> argument also expects a
        <em class="parameter"><code>root</code></em> argument.  This
        <code class="literal">svn_fs_root_t</code> argument describes
        either a revision or a Subversion transaction (which is simply
        a revision in the making) and provides that third-dimensional
        context needed to understand the difference between
        <code class="filename">/foo/bar</code> in revision 32, and the same
        path as it exists in revision 98.  <a class="xref" href="svn.developer.html#svn.developer.layerlib.repos.dia-2"  title="&#22270;&nbsp;8.2.&nbsp;&#29256;&#26412;&#26102;&#38388;&#8212;&#31532;&#19977;&#32500;&#65281;">&#22270;&nbsp;8.2 &#8220;&#29256;&#26412;&#26102;&#38388;&#8212;&#31532;&#19977;&#32500;&#65281;&#8221;</a> shows revision
        history as an added dimension to the Subversion filesystem
        universe.</p><div class="figure"><a name="svn.developer.layerlib.repos.dia-2"></a><p class="title"><b>&#22270;&nbsp;8.2.&nbsp;&#29256;&#26412;&#26102;&#38388;&#8212;&#31532;&#19977;&#32500;&#65281;</b></p><div class="figure-contents"><div class="mediaobject"><img src="images/ch08dia2.png" ></div></div></div><br class="figure-break"><p>As we mentioned earlier, the
        <code class="filename">libsvn_fs</code> API looks and feels like any
        other filesystem, except that it has this wonderful versioning
        capability.  It was designed to be usable by any program
        interested in a versioning filesystem.  Not coincidentally,
        Subversion itself is interested in that functionality.  But
        while the filesystem API should be sufficient for basic file
        and directory versioning support, Subversion wants
        more&#8212;and that is where <code class="filename">libsvn_repos</code>
        comes in.</p><p>The Subversion repository library
        (<code class="filename">libsvn_repos</code>) sits (logically speaking)
        atop the <code class="filename">libsvn_fs</code> API, providing
        additional functionality beyond that of the underlying
        versioned filesystem logic.  It does not completely wrap each
        and every filesystem function&#8212;only certain major steps
        in the general cycle of filesystem activity are wrapped by the
        repository interface.  Some of these include the creation and
        commit of Subversion transactions and the modification of
        revision properties.  These particular events are wrapped by
        the repository layer because they have hooks associated with
        them.  A repository hook system is not strictly related to
        implementing a versioning filesystem, so it lives in the
        repository wrapper library.</p><p>The hooks mechanism is but one of the reasons for the
        abstraction of a separate repository library from the rest of
        the filesystem code.  The <code class="filename">libsvn_repos</code>
        API provides several other important utilities to Subversion.
        These include the abilities to:</p><div class="itemizedlist"><ul type="disc"><li><p>Create, open, destroy, and perform recovery steps on a
            Subversion repository and the filesystem included in that
            repository.</p></li><li><p>Describe the differences between two filesystem
            trees.</p></li><li><p>Query for the commit log messages associated with all
            (or some) of the revisions in which a set of files was
            modified in the filesystem.</p></li><li><p>Generate a human-readable &#8220;<span class="quote">dump</span>&#8221; of the
            filesystem&#8212;a complete representation of the revisions in
            the filesystem.</p></li><li><p>Parse that dump format, loading the dumped revisions
            into a different Subversion repository.</p></li></ul></div><p>&#20276;&#38543;&#30528;Subversion&#30340;&#21457;&#23637;&#65292;&#29256;&#26412;&#24211;&#24211;&#20250;&#38543;&#30528;&#25991;&#20214;&#31995;&#32479;&#25552;&#20379;&#26356;&#22810;&#30340;&#21151;&#33021;&#21644;&#37197;&#32622;&#36873;&#39033;&#32780;&#19981;&#26029;&#25104;&#38271;&#12290;</p></div><div class="section" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="svn.developer.layerlib.ra"></a>&#29256;&#26412;&#24211;&#35775;&#38382;&#23618;</h3></div></div></div><p>If the Subversion Repository Layer is at &#8220;<span class="quote">the other
        end of the line,</span>&#8221; the Repository Access (RA) Layer is
        the line itself.  Charged with marshaling data between the
        client libraries and the repository, this layer includes the
        <code class="filename">libsvn_ra</code> module loader library, the RA
        modules themselves (which currently includes
        <code class="filename">libsvn_ra_neon</code>,
        <code class="filename">libsvn_ra_local</code>,
        <code class="filename">libsvn_ra_serf</code>, and
        <code class="filename">libsvn_ra_svn</code>), and any additional
        libraries needed by one or more of those RA modules (such as
        the <code class="filename">mod_dav_svn</code> Apache module or
        <code class="filename">libsvn_ra_svn</code>'s server,
        <span class="command"><strong>svnserve</strong></span>).</p><p>&#22240;&#20026;Subversion&#20351;&#29992;URL&#26469;&#35782;&#21035;&#29256;&#26412;&#24211;&#36164;&#28304;&#65292;URL&#27169;&#24335;&#30340;&#21327;&#35758;&#37096;&#20998;(&#36890;&#24120;&#26159;<code class="literal">file:</code>&#12289;<code class="literal">http:</code>&#12289;<code class="literal">https:</code>&#25110;<code class="literal">svn:</code>)&#29992;&#26469;&#30417;&#27979;&#37027;&#20010;RA&#27169;&#22359;&#29992;&#26469;&#22788;&#29702;&#36890;&#35759;&#12290;&#27599;&#20010;&#27169;&#22359;&#27880;&#20876;&#19968;&#32452;&#23427;&#20204;&#30693;&#36947;&#22914;&#20309;&#8220;<span class="quote">&#35828;&#35805;</span>&#8221;&#30340;&#21327;&#35758;&#65292;&#25152;&#20197;RA&#21152;&#36733;&#22120;&#21487;&#20197;&#22312;&#36816;&#34892;&#20013;&#30417;&#27979;&#22312;&#25163;&#36793;&#30340;&#20219;&#21153;&#20013;&#20351;&#29992;&#21738;&#20010;&#27169;&#22359;&#12290;&#36890;&#36807;&#36816;&#34892;<span class="command"><strong>svn --version</strong></span>&#65292;&#20320;&#21487;&#20197;&#30417;&#27979;Subversion&#21629;&#20196;&#34892;&#23458;&#25143;&#31471;&#25152;&#25903;&#25345;&#30340;RA&#27169;&#22359;&#21644;&#23427;&#20204;&#22768;&#26126;&#25903;&#25345;&#30340;&#21327;&#35758;&#65306;</p><pre class="screen">
$ svn --version
svn, version 1.5.0 (Beta 1)
   compiled Mar 19 2008, 14:19:42

Copyright (C) 2000-2008 CollabNet.
Subversion is open source software, see http://subversion.tigris.org/
This product includes software developed by CollabNet (http://www.Collab.Net/).

The following repository access (RA) modules are available:

* ra_neon : Module for accessing a repository via WebDAV protocol using Neon.
  - handles 'http' scheme
  - handles 'https' scheme
* ra_svn : Module for accessing a repository using the svn network protocol.
  - handles 'svn' scheme
* ra_local : Module for accessing a repository on local disk.
  - handles 'file' scheme
* ra_serf : Module for accessing a repository via WebDAV protocol using serf.
  - handles 'http' scheme
  - handles 'https' scheme

$
</pre><p>The public API exported by the RA Layer contains
        functionality necessary for sending and receiving versioned
        data to and from the repository.  And each of the available RA
        plug-ins is able to perform that task using a specific
        protocol&#8212;<code class="filename">libsvn_ra_dav</code> speaks
        HTTP/WebDAV (optionally using SSL encryption) with an Apache
        HTTP Server that is running the
        <code class="filename">mod_dav_svn</code> Subversion server module;
        <code class="filename">libsvn_ra_svn</code> speaks a custom network
        protocol with the <span class="command"><strong>svnserve</strong></span> program; and so
        on.</p><p>For those who wish to access a Subversion repository
        using still another protocol, that is precisely why the
        Repository Access Layer is modularized!  Developers can simply
        write a new library that implements the RA interface on one
        side and communicates with the repository on the other.  Your
        new library can use existing network protocols or you can
        invent your own.  You could use interprocess communication
        (IPC) calls, or&#8212;let's get crazy, shall we?&#8212;you
        could even implement an email-based protocol.  Subversion
        supplies the APIs; you supply the creativity.</p></div><div class="section" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="svn.developer.layerlib.client"></a>&#23458;&#25143;&#31471;&#23618;</h3></div></div></div><p>On the client side, the Subversion working copy is where
        all the action takes place.  The bulk of functionality
        implemented by the client-side libraries exists for the sole
        purpose of managing working copies&#8212;directories full of
        files and other subdirectories that serve as a sort of local,
        editable &#8220;<span class="quote">reflection</span>&#8221; of one or more repository
        locations&#8212;and propagating changes to and from the
        Repository Access layer.</p><p>Subversion's working copy library,
        <code class="filename">libsvn_wc</code>, is directly responsible for
        managing the data in the working copies.  To accomplish this,
        the library stores administrative information about each
        working copy directory within a special subdirectory.  This
        subdirectory, named <code class="filename">.svn</code>, is present in
        each working copy directory and contains various other files
        and directories that record state and provide a private
        workspace for administrative action.  For those familiar with
        CVS, this <code class="filename">.svn</code> subdirectory is similar in
        purpose to the <code class="filename">CVS</code> administrative
        directories found in CVS working copies.  For more information
        about the <code class="filename">.svn</code> administrative area, see
        <a class="xref" href="svn.developer.insidewc.html"  title="&#36827;&#20837;&#24037;&#20316;&#25335;&#36125;&#30340;&#31649;&#29702;&#21306;">&#8220;&#36827;&#20837;&#24037;&#20316;&#25335;&#36125;&#30340;&#31649;&#29702;&#21306;&#8221;&#19968;&#33410;</a> later in this
        chapter.</p><p>The Subversion client library,
        <code class="filename">libsvn_client</code>, has the broadest
        responsibility; its job is to mingle the functionality of the
        working copy library with that of the Repository Access Layer,
        and then to provide the highest-level API to any application
        that wishes to perform general revision control actions.  For
        example, the function
        <code class="function">svn_client_checkout()</code> takes a URL as an
        argument.  It passes this URL to the RA layer and opens an
        authenticated session with a particular repository.  It then
        asks the repository for a certain tree, and sends this tree
        into the working copy library, which then writes a full
        working copy to disk (<code class="filename">.svn</code> directories
        and all).</p><p>The client library is designed to be used by any
        application.  While the Subversion source code includes a
        standard command-line client, it should be very easy to write
        any number of GUI clients on top of the client library.  New
        GUIs (or any new client, really) for Subversion need not be
        clunky wrappers around the included command-line
        client&#8212;they have full access via the
        <code class="filename">libsvn_client</code> API to the same functionality,
        data, and callback mechanisms that the command-line client
        uses.  In fact, the Subversion source code tree contains a
        small C program (which can be found at
        <code class="filename">tools/examples/minimal_client.c</code>) that
        exemplifies how to wield the Subversion API to create a simple
        client program.</p><div class="sidebar"><p class="title"><b>&#30452;&#25509;&#32465;&#23450;&#8212;&#20851;&#20110;&#27491;&#30830;&#24615;</b></p><p>Why should your GUI program bind directly with a
          <code class="filename">libsvn_client</code> instead of acting as a
          wrapper around a command-line program?  Besides simply being
          more efficient, it can be more correct as well.  A
          command-line program (such as the one supplied with
          Subversion) that binds to the client library needs to
          effectively translate feedback and requested data bits from
          C types to some form of human-readable output.  This type of
          translation can be lossy.  That is, the program may not
          display all of the information harvested from the API or may
          combine bits of information for compact
          representation.</p><p>If you wrap such a command-line program with yet another
          program, the second program has access only to
          already interpreted (and as we mentioned, likely incomplete)
          information, which it must <span class="emphasis"><em>again</em></span>
          translate into <span class="emphasis"><em>its</em></span> representation
          format.  With each layer of wrapping, the integrity of the
          original data is potentially tainted more and more, much
          like the result of making a copy of a copy (of a copy&#8230;)
          of a favorite audio or video cassette.</p><p>&#20294;&#26159;&#20851;&#20110;&#30452;&#25509;&#32465;&#23450;API&#20351;&#29992;&#65292;&#32780;&#19981;&#26159;&#21253;&#35065;&#31243;&#24207;&#65292;&#36825;&#26159;Subversion&#39033;&#30446;&#23545;&#20854;API&#20860;&#23481;&#24615;&#30340;&#25215;&#35834;&#12290;&#22312;&#23567;&#29256;&#26412;&#30340;&#21464;&#21270;(&#22914;&#20174;1.3&#21040;1.4)&#20013;API&#30340;&#19981;&#20250;&#26377;&#20989;&#25968;&#21407;&#24418;&#30340;&#25913;&#21464;&#65292;&#31616;&#21333;&#26469;&#35828;&#23601;&#26159;&#20320;&#19981;&#38656;&#35201;&#23558;&#20320;&#31243;&#24207;&#28304;&#20195;&#30721;&#21319;&#32423;&#65292;&#22240;&#20026;&#20320;&#21482;&#26159;&#21319;&#32423;&#21040;&#20102;&#19968;&#20010;&#26032;&#29256;&#26412;&#30340;Subversion&#12290;&#26576;&#20123;&#26041;&#27861;&#21487;&#33021;&#20250;&#34987;&#24223;&#24323;&#65292;&#20294;&#20381;&#28982;&#24037;&#20316;&#65292;&#36825;&#32473;&#20320;&#20102;&#32531;&#20914;&#26102;&#38388;&#26469;&#26368;&#32456;&#36866;&#24212;&#26032;API&#12290;Subversion&#30340;&#21629;&#20196;&#34892;&#36755;&#20986;&#27809;&#26377;&#36825;&#31181;&#20860;&#23481;&#24615;&#25215;&#35834;&#65292;&#21487;&#33021;&#20250;&#22312;&#27599;&#20010;&#29256;&#26412;&#26356;&#25913;&#12290;</p></div></div></div><div class="footnotes"><br><hr width="100" align="left"><div class="footnote"><p><sup>[<a name="ftn.d0e15625" href="svn.developer.html#d0e15625" class="para">50</a>] </sup>&#25105;&#20204;&#29702;&#35299;&#36825;&#19968;&#23450;&#20250;&#32473;&#31185;&#24187;&#23567;&#35828;&#36855;&#24102;&#26469;&#19968;&#20010;&#38663;&#25788;&#65292;&#20182;&#20204;&#35748;&#20026;&#26102;&#38388;&#26159;<span class="emphasis"><em>&#31532;&#22235;</em></span>&#32500;&#30340;&#65292;&#25105;&#20204;&#35201;&#20026;&#25552;&#20986;&#36825;&#26679;&#19968;&#20010;&#19981;&#21516;&#29702;&#35770;&#30340;&#26029;&#35328;&#32780;&#20260;&#23475;&#20102;&#20182;&#20204;&#30340;&#20316;&#20986;&#36947;&#27465;&#12290;</p></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="svn.advanced.externaldifftools.html" >&#19978;&#19968;&#39029;</a>&nbsp;</td><td width="20%" align="center">&nbsp;</td><td width="40%" align="right">&nbsp;<a accesskey="n" href="svn.developer.insidewc.html" >&#19979;&#19968;&#39029;</a></td></tr><tr><td width="40%" align="left" valign="top">Using External Differencing and Merge Tools&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html" >&#36215;&#22987;&#39029;</a></td><td width="40%" align="right" valign="top">&nbsp;&#36827;&#20837;&#24037;&#20316;&#25335;&#36125;&#30340;&#31649;&#29702;&#21306;</td></tr></table></div></body></html>