<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3c.org/TR/1999/REC-html401-19991224/loose.dtd">
<HTML xmlns="http://www.w3.org/1999/xhtml">
<HEAD><TITLE>Stub Status模块（Stub Status）</TITLE>
<META http-equiv=Content-Type content="text/html; charset=GB2312">
<STYLE type=text/css>PRE {
	BACKGROUND-COLOR: #cccccc
}
.STYLE1 {
	COLOR: #ff0000
}
</STYLE>

<META content="MSHTML 6.00.6000.16809" name=GENERATOR></HEAD>
<BODY>
<H2>Stub Status模块（Stub Status）</H2><BR>

<H3>・摘要</H3>
<H4>这个模块可以取得一些nginx的运行状态。<BR>
要使用这个模块必须在编译时指定下列编译参数：<BR>
<PRE>--with-http_stub_status_module</PRE>
示例配置：<BR>
<PRE>location /nginx_status {
  # copied from http://blog.kovyrin.net/2006/04/29/monitoring-nginx-with-rrdtool/
  stub_status on;
  access_log   off;
  allow SOME.IP.ADD.RESS;
  deny all;
}
</PRE></H4>
<H3>・指令</H3>
<H3>stub_status </H3>
<H4>语法：stub_status on <BR>
默认值：none <BR>
使用字段：location <BR>
在这个location中启用状态监测。<BR>
这个模块可以生成一个类似<A href="http://www.mathopd.org/" >mathopd</A>状态页面的纯文本信息：
<PRE>Active connections: 291
server accepts handled requests
  16630948 16630948 31070465
Reading: 6 Writing: 179 Waiting: 106
</PRE>
active connections -- 所有打开的连接，包括连接到后端服务器的。<BR>
server accepts handled requests -- nginx已经接受并处理16630948个连接，31070465个请求（每个连接1.8个请求）。<BR>
reading -- 读取的请求头。<BR>
writing -- 读取的请求主体，处理的请求或者写入的应答。<BR>
waiting -- keepalive连接数，等于active - (reading + writing)。</H4>
<H3>・参考文档</H3>
<H4><A href="http://blog.kovyrin.net/2006/04/29/monitoring-nginx-with-rrdtool/" >使用rrd监控nginx</A><BR>
<A href="http://dev.2xlp.com/svn/nginx_config/trunk/conf/_rrd/__README__.txt" >rrd readme</A><BR>
<A href="http://wiki.nginx.org/NginxHttpStubStatusModule/" >Nginx Http Stub Status Module</A><BR></H4>
<!-- Piwik -->
<script type="text/javascript">
var pkBaseURL = (("https:" == document.location.protocol) ? "https://179401.cn/analytics/" : "http://179401.cn/analytics/");
document.write(unescape("%3Cscript src='" + pkBaseURL + "piwik.js' type='text/javascript'%3E%3C/script%3E"));
</script><script type="text/javascript">
try {
var piwikTracker = Piwik.getTracker(pkBaseURL + "piwik.php", 1);
piwikTracker.trackPageView();
piwikTracker.enableLinkTracking();
} catch( err ) {}
</script><noscript><p><img src="http://shouce.jb51.net/179401.cn/analytics/piwik.php-idsite=1"  style="border:0" alt=""/></p></noscript>
<!-- End Piwik Tag -->
</BODY>
</HTML>
<H3><A href="Substitution.html" >前进->Substitution模块（Substitution）</A></H3>