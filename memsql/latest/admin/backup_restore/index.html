<!DOCTYPE html>
    <!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
    <!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
         <title>Backing Up and Restoring Data</title> 
        <link rel="shortcut icon" href="../../../static_star_theme/img/favicon.ico"/>
        <link href='http://fonts.googleapis.com/css?family=Lato:300,400,700,300italic,700italic' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" href="../../../static_star_theme/css/theme.css" type="text/css" /> 
        <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>
    </head>

    <body class="wy-body-for-nav" role="document">

    <div class="wy-grid-for-nav">

        <div class="wy-full-navbar" data-swiftype-index="false">
            <a href="http://www.memsql.com" class="logo">
                <img src="../../../static_star_theme/img/memsql_logo_horizontal_white.svg" />
            </a>
            <div class="global nav">
                <div class="pull-left left-links">
                </div>
                <div class="pull-right right-links">
                    <a href="http://www.memsql.com/community/" style="word-spacing: 2px;">Community Edition</a>
                    <a href="http://blog.memsql.com">Blog</a>
                    <a href="http://www.memsql.com/memsql-partners">Partners</a>
                    <a href="http://www.memsql.com/resources">Resources</a>
                    <a href="../../../index.html">Documentation</a>
                    <a href="http://www.memsql.com/contact">Contact</a>
                </div>
            </div>
            <div class="nav-links">
                <a href="http://www.memsql.com/product">Product</a>
                <a href="http://www.memsql.com/solutions">Solutions</a>
                <a href="http://www.memsql.com/case-studies">Case Studies</a>
                <a href="http://www.memsql.com/company">Company</a>
                <a class="download" href="http://www.memsql.com/download/">Download Now</a>
            </div>
        </div>

        <nav data-toggle="wy-nav-shift" class="wy-nav-side" data-swiftype-index="false">
            <div class="wy-side-nav-search">
                <div role="search">
  <form id="search-form" class="wy-form" method="get">
    <input type="text" id="st-search-input" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
            </div>

            <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                
                 <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../index.html">MemSQL Docs Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../intro/index.html">How MemSQL Works</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../setup/quick_start/index.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../setup/get_started/index.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../concepts/index.html">User Manual</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Operations Manual</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../upgrade/index.html">Upgrading MemSQL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../admin_concepts/index.html">Administrator Key Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cluster/index.html">Administering a Cluster</a></li>
<li class="toctree-l2"><a class="reference internal" href="../security/index.html">Securing MemSQL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ssl/index.html">SSL Network Encryption</a></li>
<li class="toctree-l2"><a class="reference internal" href="../high_availability/index.html">Managing High Availability</a></li>
<li class="toctree-l2"><a class="reference internal" href="../durability_recovery/index.html">Using Durability and Recovery</a></li>
<li class="toctree-l2"><a class="reference internal" href="../replication/index.html">Using Replication</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="index.html">Backing Up and Restoring Data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#backup-and-restore-on-nfs-network-file-system">Backup and Restore on NFS (Network File System)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../data_export/index.html">Exporting Data From MemSQL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tracelog/index.html">Trace Log</a></li>
<li class="toctree-l2"><a class="reference internal" href="../from_mysql/index.html">Transitioning from MySQL to MemSQL</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../ref/commands_by_type/index.html">SQL Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../config/index.html">Configuration Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ops/index.html">MemSQL Ops</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../loader/index.html">MemSQL Loader</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../archive/index.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../editions/index.html">MemSQL Editions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq/index.html">Frequently Asked Questions</a></li>
</ul>
 
            </div>
            &nbsp;
        </nav>

        <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
            <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
                <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
                <a href="../../../index.html" class="logo">
                    <img src="../../../static_star_theme/img/memsql_logo_horizontal_white.svg" />
                    <span class="subtitle">Documentation</span>
                </a>
            </nav>

            <div class="wy-nav-content">
                <div class="rst-content">
                    <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../../index.html">MemSQL Documentation</a> &raquo;</li>
      
          <li><a href="../index.html">Operations Manual</a> &raquo;</li>
      
    <li>Backing Up and Restoring Data</li>
      <li class="wy-breadcrumbs-aside">
        
      </li>
  </ul>
  <hr/>
</div>
                    <div role="main" class="document">
                        
  <div class="section" id="backing-up-and-restoring-data">
<span id="backup-restore"></span><h1>Backing Up and Restoring Data<a class="headerlink" href="index.html#backing-up-and-restoring-data" title="Permalink to this headline">¶</a></h1>
<p>MemSQL provides <a class="reference internal" href="../../ref/BACKUP/index.html"><em>BACKUP</em></a> and <a class="reference internal" href="../../ref/RESTORE/index.html"><em>RESTORE</em></a> commands for making and restoring from binary database backups. <a class="reference internal" href="../../ref/BACKUP/index.html"><em>BACKUP</em></a> writes a consistent snapshot of the database to disk across the cluster. <a class="reference internal" href="../../ref/RESTORE/index.html"><em>RESTORE</em></a> replays a binary backup files in the same manner in which MemSQL recovers a database snapshot during startup to restore the database on all nodes in the cluster.</p>
<p>A <tt class="docutils literal"><span class="pre">BACKUP</span></tt> operation creates one <tt class="docutils literal"><span class="pre">.backup</span></tt> file for each master partition in the cluster.  Each leaf node backs up its master partitions in parallel.  The backup files created by the leaves are stored in the destination directory provided to <tt class="docutils literal"><span class="pre">BACKUP</span></tt> by each leaf.
At present, MemSQL doesn&#8217;t move the <tt class="docutils literal"><span class="pre">.backup</span></tt> files off the leaf nodes, its up to you to move them to a safe location.  The easiest way to accomplish this is to use a NFS (Network File System) as described below. To <tt class="docutils literal"><span class="pre">RESTORE</span></tt> a backup the leaves will need access to all the <tt class="docutils literal"><span class="pre">.backup</span></tt> files created by <tt class="docutils literal"><span class="pre">BACKUP</span></tt>.  The <tt class="docutils literal"><span class="pre">RESTORE</span></tt> command won&#8217;t copy the <tt class="docutils literal"><span class="pre">.backup</span></tt> files to the leaves, the files needs to already exists there. <tt class="docutils literal"><span class="pre">RESTORE</span></tt> will handle replaying them back into memory and setting up slave partitions if the cluster is running in redundancy 2.</p>
<div class="admonition-feature-note admonition" id="feature-note-0">
<p class="first admonition-title">Feature Note</p>
<p class="last">This feature is only available in MemSQL Enterprise Edition. See the <a class="reference internal" href="../../editions/index.html"><em>editions page</em></a>
for a full list of features.</p>
</div>
<div class="section" id="backup-and-restore-on-nfs-network-file-system">
<h2>Backup and Restore on NFS (Network File System)<a class="headerlink" href="index.html#backup-and-restore-on-nfs-network-file-system" title="Permalink to this headline">¶</a></h2>
<p>MemSQL makes <a class="reference internal" href="../../ref/BACKUP/index.html"><em>BACKUP</em></a> and <a class="reference internal" href="../../ref/RESTORE/index.html"><em>RESTORE</em></a> easy to use with a Network File System (NFS). When running <a class="reference internal" href="../../ref/BACKUP/index.html"><em>BACKUP</em></a>, simply select a <tt class="docutils literal"><span class="pre">backup_path</span></tt> that points to a directory shared between each of the nodes in the cluster. MemSQL creates a single copy of every partition, regardless of the cluster&#8217;s redundancy level, and stores them in the shared location. The following example creates a backup on each node in the <tt class="docutils literal"><span class="pre">/var/lib/memsql/data</span></tt> directory.</p>
<div class="highlight-none"><div class="highlight"><pre>mysql&gt; BACKUP DATABASE memsql_demo to &quot;./&quot;;
Query OK, 1 row affected (6.32 sec)
</pre></div>
</div>
<p>Then, when you run <a class="reference internal" href="../../ref/RESTORE/index.html"><em>RESTORE</em></a> on the master aggregator, MemSQL handles the distribution and balancing of database partitions across the restored cluster.
MemSQL&#8217;s distributed <a class="reference internal" href="../../ref/RESTORE/index.html"><em>RESTORE</em></a> even handles replication, creating master and slave partitions on paired leaf nodes automatically. The following example restores from the <tt class="docutils literal"><span class="pre">/var/lib/memsql/data/</span></tt> directory.</p>
<div class="highlight-none"><div class="highlight"><pre>memsql&gt; RESTORE DATABASE memsql_demo FROM &quot;./&quot;;
Query OK, 1 row affected, 2 warnings (44.52 sec)
</pre></div>
</div>
<p>If your cluster is not on NFS and you are restoring a cluster with a different configuration or on
different hardware than the original, you must manually distribute partitions across the cluster
before running <a class="reference internal" href="../../ref/RESTORE/index.html"><em>RESTORE</em></a>. If the cluster has redundancy level greater than one, you must
group leaf nodes into replication pairs. Paired nodes must have the same set of partition backups
in their local backup directories (specified by <tt class="docutils literal"><span class="pre">backup_path</span></tt>). MemSQL will automatically choose
master and slave partitions when you run <a class="reference internal" href="../../ref/RESTORE/index.html"><em>RESTORE</em></a> on the master aggregator.</p>
<p><strong>Related Topics</strong></p>
<ul class="simple">
<li><a class="reference internal" href="../../ref/BACKUP/index.html"><em>BACKUP</em></a></li>
<li><a class="reference internal" href="../../ref/RESTORE/index.html"><em>RESTORE</em></a></li>
</ul>
</div>
</div>


                    </div>
                    <footer data-swiftype-index="false">
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../data_export/index.html" class="btn btn-neutral float-right" title="Exporting Data From MemSQL">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../replication/index.html" class="btn btn-neutral" title="Using Replication"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>&copy; Copyright 2015, MemSQL</p>
  </div>
</footer>
                </div>
            </div>

        </section>
    </div>

    <script type="text/javascript" src="../../../static_star_theme/js/jquery-2.1.1.min.js"></script>
    <script type="text/javascript" src="../../../static_star_theme/js/underscore-min.js"></script>
    <script type="text/javascript" src="../../../static_star_theme/js/jquery.ba-hashchange.min.js"></script>
    <script type="text/javascript" src="../../../static_star_theme/js/jquery.swiftype.search.js"></script>
    <script type="text/javascript" src="../../../static_star_theme/js/jquery.swiftype.autocomplete.js"></script>
    <script type="text/javascript" src="../../../static_star_theme/js/theme.js"></script>
    <script type="text/javascript" src="../../../static_star_theme/js/search.js"></script> 

        <!-- Google Analytics -->
        <script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-21693588-3', 'auto');
            ga('send', 'pageview');
        </script>
        <!-- End Google Analytics -->

        <script type="text/javascript">
            $.ajax({
                url: document.location.protocol + '//munchkin.marketo.net/munchkin.js',
                dataType: 'script',
                cache: true,
                success: function() {
                    Munchkin.init('759-YLI-316');
                }
            });
        </script>
    </body>
</html>