<!DOCTYPE html>
    <!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
    <!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
         <title>Geospatial Guide</title> 
        <link rel="shortcut icon" href="../../../static_star_theme/img/favicon.ico"/>
        <link href='http://fonts.googleapis.com/css?family=Lato:300,400,700,300italic,700italic' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" href="../../../static_star_theme/css/theme.css" type="text/css" /> 
        <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>
    </head>

    <body class="wy-body-for-nav" role="document">

    <div class="wy-grid-for-nav">

        <div class="wy-full-navbar" data-swiftype-index="false">
            <a href="http://www.memsql.com" class="logo">
                <img src="../../../static_star_theme/img/memsql_logo_horizontal_white.svg" />
            </a>
            <div class="global nav">
                <div class="pull-left left-links">
                </div>
                <div class="pull-right right-links">
                    <a href="http://www.memsql.com/community/" style="word-spacing: 2px;">Community Edition</a>
                    <a href="http://blog.memsql.com">Blog</a>
                    <a href="http://www.memsql.com/memsql-partners">Partners</a>
                    <a href="http://www.memsql.com/resources">Resources</a>
                    <a href="../../../index.html">Documentation</a>
                    <a href="http://www.memsql.com/contact">Contact</a>
                </div>
            </div>
            <div class="nav-links">
                <a href="http://www.memsql.com/product">Product</a>
                <a href="http://www.memsql.com/solutions">Solutions</a>
                <a href="http://www.memsql.com/case-studies">Case Studies</a>
                <a href="http://www.memsql.com/company">Company</a>
                <a class="download" href="http://www.memsql.com/download/">Download Now</a>
            </div>
        </div>

        <nav data-toggle="wy-nav-shift" class="wy-nav-side" data-swiftype-index="false">
            <div class="wy-side-nav-search">
                <div role="search">
  <form id="search-form" class="wy-form" method="get">
    <input type="text" id="st-search-input" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
            </div>

            <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                
                 <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../index.html">MemSQL Docs Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../intro/index.html">How MemSQL Works</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../setup/quick_start/index.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../setup/get_started/index.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">User Manual</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../connecting/index.html">How to Connect to MemSQL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../how_to_run_queries/index.html">How to Run Queries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../multi_insert_examples/index.html">Concurrent Multi-Insert Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data_loading/index.html">Loading Data Into MemSQL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../porting-apps/index.html">How to Port Your Applications to MemSQL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../memory_management/index.html">Memory Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../distributed_architecture/index.html">Distributed Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="../codegen/index.html">Code Generation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../key_concepts/index.html">Database Key Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../distributed_sql/index.html">Distributed SQL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../columnar/index.html">Column Store</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="index.html">Geospatial Guide</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#geospatial-types">Geospatial types</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#creating-a-geospatial-table">Creating a geospatial table</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#querying-geospatial-data">Querying geospatial data</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#spatial-joins">Spatial Joins</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#geospatial-model">Geospatial Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#columnstore-geospatial">Columnstore Geospatial</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#special-spatial-tuning-parameters">Special Spatial Tuning Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#using-geojson-data">Using GeoJSON Data</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../json/json/index.html">Javascript Object Notation (JSON)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../admin/index.html">Operations Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ref/commands_by_type/index.html">SQL Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../admin/config/index.html">Configuration Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ops/index.html">MemSQL Ops</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../loader/index.html">MemSQL Loader</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../archive/index.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../editions/index.html">MemSQL Editions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq/index.html">Frequently Asked Questions</a></li>
</ul>
 
            </div>
            &nbsp;
        </nav>

        <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
            <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
                <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
                <a href="../../../index.html" class="logo">
                    <img src="../../../static_star_theme/img/memsql_logo_horizontal_white.svg" />
                    <span class="subtitle">Documentation</span>
                </a>
            </nav>

            <div class="wy-nav-content">
                <div class="rst-content">
                    <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../../index.html">MemSQL Documentation</a> &raquo;</li>
      
          <li><a href="../index.html">User Manual</a> &raquo;</li>
      
    <li>Geospatial Guide</li>
      <li class="wy-breadcrumbs-aside">
        
      </li>
  </ul>
  <hr/>
</div>
                    <div role="main" class="document">
                        
  <div class="section" id="geospatial-guide">
<h1>Geospatial Guide<a class="headerlink" href="index.html#geospatial-guide" title="Permalink to this headline">¶</a></h1>
<p>With version 4, MemSQL has added support for geospatial queries. The term &#8220;geospatial&#8221; covers a very broad range of features. There is a formal standardization for some of those features, known as SQL-MM or OpenGIS. The features in MemSQL are not yet a complete implementation of that standard, but follows the same structure.</p>
<p>At a basic level, geospatial support requires three things: datatypes, topological functions, and measurement functions.</p>
<div class="section" id="geospatial-types">
<span id="geospatial-wkt-syntax"></span><h2>Geospatial types<a class="headerlink" href="index.html#geospatial-types" title="Permalink to this headline">¶</a></h2>
<img alt="../../_images/geospatial-types.png" class="align-center" src="../../_images/geospatial-types.png" />
<p>The three main geospatial object types are points, paths, and polygons. We support a subset of the standard &#8220;Well-Known Text&#8221; (WKT) syntax to describe them. For example, a POINT is a simple longitude / latitude pair. Note the lack of a comma between the numbers.</p>
<div class="highlight-none"><div class="highlight"><pre>&quot;POINT(-74.044514 40.689244)&quot;
</pre></div>
</div>
<p>A linestring or path object is an ordered list of points. Note the double parenthesis around pairs of numbers, which are separated by commas.</p>
<div class="highlight-none"><div class="highlight"><pre>&quot;LINESTRING((0 0, 0 1, 1 1))&quot;
</pre></div>
</div>
<p>A polygon is similar to a linestring, except that it is &#8220;closed&#8221;, that is to say, it must have at least three unique points, and the first and last point-pairs must be equal:</p>
<div class="highlight-none"><div class="highlight"><pre>&quot;POLYGON((0 0, 0 1, 1 1, 0 0))&quot;
</pre></div>
</div>
<p>You can also describe multiple shapes inside a polygon object, for example, a set of islands, or a lake inside a country.</p>
<div class="highlight-none"><div class="highlight"><pre>&quot;POLYGON((0 0, 0 1, 1 1, 0 0), (5 5, 6 5, 5 6, 5 5))&quot;
</pre></div>
</div>
<p>All geospatial functions can accept either a geospatial object or the equivalent WKT string as arguments. MemSQL does not yet support the MULTIPOLYGON, GEOMETRY, CURVE, or other keywords.</p>
</div>
<div class="section" id="creating-a-geospatial-table">
<h2>Creating a geospatial table<a class="headerlink" href="index.html#creating-a-geospatial-table" title="Permalink to this headline">¶</a></h2>
<p>Geospatial objects are just another data type in MemSQL and can be used right alongside numbers, strings, and JSON. To create a column that holds point data, use the <tt class="docutils literal"><span class="pre">GeographyPoint</span></tt> type. For path and polygon data, use the <tt class="docutils literal"><span class="pre">Geography</span></tt> type.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">It is possible to store POINTs in the <cite>Geography</cite> type, but is not recommended. The <cite>GeographyPoint</cite> type was designed specifically for point data, and is highly optimized for memory efficiency and speed.</p>
</div>
<p>In this example, we’ll create a table of neighborhoods. The &#8220;centroid&#8221; field is the point that is roughly in the middle of the borders of the neighborhood. The &#8220;shape&#8221; field is the polygon describing those borders. All geospatial data can be indexed for very high query performance.</p>
<div class="highlight-mysql"><div class="highlight"><pre><span class="k">create</span> <span class="k">table</span> <span class="nf">neighborhoods</span> <span class="p">(</span>
  <span class="n">id</span> <span class="kt">int</span> <span class="k">unsigned</span> <span class="k">not</span> <span class="no">null</span> <span class="k">primary</span> <span class="k">key</span><span class="p">,</span>
  <span class="n">name</span> <span class="kt">varchar</span><span class="p">(</span><span class="mi">64</span><span class="p">)</span> <span class="k">not</span> <span class="no">null</span><span class="p">,</span>
  <span class="n">population</span> <span class="kt">int</span> <span class="k">unsigned</span> <span class="k">not</span> <span class="no">null</span><span class="p">,</span>
  <span class="n">shape</span> <span class="n">GEOGRAPHY</span> <span class="k">not</span> <span class="no">null</span><span class="p">,</span>
  <span class="n">centroid</span> <span class="n">GEOGRAPHYPOINT</span> <span class="k">not</span> <span class="no">null</span><span class="p">,</span>

  <span class="k">index</span> <span class="p">(</span><span class="n">shape</span><span class="p">)</span> <span class="k">with</span> <span class="p">(</span><span class="n">resolution</span> <span class="o">=</span> <span class="mi">8</span><span class="p">)</span>
  <span class="k">index</span> <span class="p">(</span><span class="n">centroid</span><span class="p">),</span>
<span class="p">);</span>

<span class="k">insert</span> <span class="k">into</span> <span class="n">neighborhoods</span> <span class="k">values</span>
<span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Hamilton&quot;</span><span class="p">,</span> <span class="mi">12346</span><span class="p">,</span> <span class="s2">&quot;POLYGON((....))&quot;</span><span class="p">,</span> <span class="p">...),</span>
<span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;Probability Bay&quot;</span><span class="p">,</span> <span class="mi">263951</span><span class="p">,</span> <span class="s2">&quot;POLYGON((....))&quot;</span><span class="p">,</span> <span class="p">...),</span>
<span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;Decentralized Park&quot;</span><span class="p">,</span> <span class="mi">29265</span><span class="p">,</span> <span class="s2">&quot;POLYGON((....))&quot;</span><span class="p">,</span> <span class="p">...),</span>
<span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;Axiom Township&quot;</span><span class="p">,</span> <span class="mi">845696</span><span class="p">,</span> <span class="s2">&quot;POLYGON((....))&quot;</span><span class="p">,</span> <span class="p">...)</span>
<span class="p">...</span>
</pre></div>
</div>
</div>
<div class="section" id="querying-geospatial-data">
<h2>Querying geospatial data<a class="headerlink" href="index.html#querying-geospatial-data" title="Permalink to this headline">¶</a></h2>
<img alt="../../_images/geospatial-functions.png" class="align-center" src="../../_images/geospatial-functions.png" />
<p>You can run queries over the neighborhood data to see how they relate to each other spatially. For example, you can join the table to itself and measure distances between neighborhoods:</p>
<div class="highlight-mysql"><div class="highlight"><pre><span class="n">memsql</span><span class="o">&gt;</span> <span class="k">select</span> <span class="n">b</span><span class="p">.</span><span class="n">name</span> <span class="k">as</span> <span class="n">town</span><span class="p">,</span>
    <span class="o">-&gt;</span> <span class="nf">round</span><span class="p">(</span><span class="nf">GEOGRAPHY_DISTANCE</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">centroid</span><span class="p">,</span> <span class="n">b</span><span class="p">.</span><span class="n">centroid</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span> <span class="k">as</span> <span class="n">distance_from_center</span><span class="p">,</span>
    <span class="o">-&gt;</span> <span class="nf">round</span><span class="p">(</span><span class="nf">GEOGRAPHY_DISTANCE</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">b</span><span class="p">.</span><span class="n">shape</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span> <span class="k">as</span> <span class="n">distance_from_border</span>
    <span class="o">-&gt;</span> <span class="k">from</span> <span class="n">neighborhoods</span> <span class="n">a</span><span class="p">,</span> <span class="n">neighborhoods</span> <span class="n">b</span>
    <span class="o">-&gt;</span> <span class="k">where</span> <span class="n">a</span><span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="o">-&gt;</span> <span class="k">order</span> <span class="k">by</span> <span class="mi">2</span><span class="p">;</span>
<span class="o">+---------------------+----------------------+----------------------+</span>
<span class="o">|</span> <span class="n">town</span>                <span class="o">|</span> <span class="n">distance_from_center</span> <span class="o">|</span> <span class="n">distance_from_border</span> <span class="o">|</span>
<span class="o">+---------------------+----------------------+----------------------+</span>
<span class="o">|</span> <span class="n">Probability</span> <span class="n">Bay</span>     <span class="o">|</span>                    <span class="mi">0</span> <span class="o">|</span>                    <span class="mi">0</span> <span class="o">|</span>
<span class="o">|</span> <span class="n">Lower</span> <span class="n">Bound</span> <span class="n">Valley</span>  <span class="o">|</span>                 <span class="mi">1924</span> <span class="o">|</span>                    <span class="mi">0</span> <span class="o">|</span>
<span class="o">|</span> <span class="n">Axiom</span> <span class="n">Township</span>      <span class="o">|</span>                 <span class="mi">2907</span> <span class="o">|</span>                    <span class="mi">0</span> <span class="o">|</span>
<span class="o">|</span> <span class="n">Elegant</span> <span class="n">Island</span>      <span class="o">|</span>                 <span class="mi">4551</span> <span class="o">|</span>                 <span class="mi">1935</span> <span class="o">|</span>
<span class="o">|</span> <span class="n">Upper</span> <span class="n">Bound</span> <span class="n">Hill</span>    <span class="o">|</span>                 <span class="mi">7866</span> <span class="o">|</span>                 <span class="mi">5632</span> <span class="o">|</span>
<span class="o">|</span> <span class="n">Big</span> <span class="n">Endian</span>          <span class="o">|</span>                <span class="mi">11374</span> <span class="o">|</span>                 <span class="mi">9016</span> <span class="o">|</span>
<span class="o">|</span> <span class="n">Little</span> <span class="n">Endian</span>       <span class="o">|</span>                <span class="mi">19275</span> <span class="o">|</span>                <span class="mi">17290</span> <span class="o">|</span>
<span class="o">|</span> <span class="n">Isle</span> <span class="n">Zero</span>           <span class="o">|</span>                <span class="mi">19439</span> <span class="o">|</span>                <span class="mi">17163</span> <span class="o">|</span>
<span class="p">...</span>
</pre></div>
</div>
<p>You can also find out where you are with GEOGRAPHY_INTERSECTS:</p>
<div class="highlight-mysql"><div class="highlight"><pre><span class="n">memsql</span><span class="o">&gt;</span> <span class="k">select</span> <span class="n">id</span><span class="p">,</span> <span class="n">name</span> <span class="k">from</span> <span class="n">neighborhoods</span> <span class="k">where</span>
    <span class="o">-&gt;</span> <span class="nf">GEOGRAPHY_INTERSECTS</span><span class="p">(</span><span class="s2">&quot;POINT(-73.94990499 40.69150746)&quot;</span><span class="p">,</span> <span class="n">shape</span><span class="p">);</span>
<span class="o">+----+----------+</span>
<span class="o">|</span> <span class="n">id</span> <span class="o">|</span> <span class="n">name</span>     <span class="o">|</span>
<span class="o">+----+----------+</span>
<span class="o">|</span>  <span class="mi">1</span> <span class="o">|</span> <span class="n">Hamilton</span> <span class="o">|</span>
<span class="o">+----+----------+</span>
<span class="mi">1</span> <span class="n">row</span> <span class="k">in</span> <span class="kt">set</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">00</span> <span class="n">sec</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="spatial-joins">
<h2>Spatial Joins<a class="headerlink" href="index.html#spatial-joins" title="Permalink to this headline">¶</a></h2>
<p>Geospatial objects are first-class datatypes in MemSQL, which means that you can use spatial relationships to join tables. For example, to find all of the businesses in your neighborhood, you join the businesses table with the neighborhoods table on whether the business location (a point) is contained by the neighborhood’s shape (a polygon).</p>
<div class="highlight-mysql"><div class="highlight"><pre>memsql&gt; select b.id, b.name from businesses b, neighborhoods n
    -&gt; where n.name=&quot;Abstract Island&quot; and
    -&gt; GEOGRAPHY_CONTAINS(n.shape, b.location);
+----+------------------------------+
| id | name                         |
+----+------------------------------+
|  2 | Touring Machines Bike Repair |
| 17 | Random Slice Pizza           |
| 34 | The Philosopher&#39;s Diner      |
| 51 | Push &amp; Pop Cafe              |
...
</pre></div>
</div>
<p>These functions and many more are documented in the <a class="reference internal" href="../../ref/functions/index.html#functions-geospatial"><em>MemSQL Geospatial Reference</em></a>.</p>
</div>
<div class="section" id="geospatial-model">
<h2>Geospatial Model<a class="headerlink" href="index.html#geospatial-model" title="Permalink to this headline">¶</a></h2>
<p>MemSQL 4 uses a spherical model similar to that used in Google Earth. It assumes a perfectly spherical Earth with a radius of 6,367,444.66 meters. The real Earth is not a sphere. It resembles an ellipsoid slightly wider than it is tall, with many local variations. In a spherical model, measurements of distance and area may vary from reality. For example, a 10,000 meter line drawn vertically over San Francisco would measure about 10,020 meters in this model. Topological functions, which describe the relationships between shapes and points, less affected by this difference.</p>
</div>
<div class="section" id="columnstore-geospatial">
<h2>Columnstore Geospatial<a class="headerlink" href="index.html#columnstore-geospatial" title="Permalink to this headline">¶</a></h2>
<p>In MemSQL 4, geospatial data and functions are supported in columnstore (ie on-disk) tables. Columnstore tables do not yet support indexes on geo data. The native <tt class="docutils literal"><span class="pre">GeographyPoint</span></tt> type is supported but the <tt class="docutils literal"><span class="pre">Geography</span></tt> type is not. However, you can store path and polygon data in a plain text field, and run geospatial functions over them just as you do with rowstore (in-memory) tables.</p>
<div class="highlight-mysql"><div class="highlight"><pre><span class="k">create</span> <span class="n">COLUMNSTORE</span> <span class="k">table</span> <span class="nf">neighborhoods_columnstore</span> <span class="p">(</span>
  <span class="n">id</span> <span class="kt">int</span> <span class="k">unsigned</span> <span class="k">not</span> <span class="no">null</span><span class="p">,</span>
  <span class="n">name</span> <span class="kt">varchar</span><span class="p">(</span><span class="mi">64</span><span class="p">)</span> <span class="k">not</span> <span class="no">null</span><span class="p">,</span>
  <span class="n">population</span> <span class="kt">int</span> <span class="k">unsigned</span> <span class="k">not</span> <span class="no">null</span><span class="p">,</span>
  <span class="n">centroid</span> <span class="n">GEOGRAPHYPOINT</span> <span class="k">not</span> <span class="no">null</span><span class="p">,</span>
  <span class="n">shape</span> <span class="kt">TEXT</span> <span class="k">not</span> <span class="no">null</span>
<span class="p">);</span>

<span class="k">insert</span> <span class="k">into</span> <span class="n">neighborhoods_columnstore</span> <span class="k">values</span>
<span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Hamilton&quot;</span><span class="p">,</span> <span class="mi">12346</span><span class="p">,</span> <span class="s2">&quot;POLYGON((....))&quot;</span><span class="p">,</span> <span class="p">...),</span>
<span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;Probability Bay&quot;</span><span class="p">,</span> <span class="mi">263951</span><span class="p">,</span> <span class="s2">&quot;POLYGON((....))&quot;</span><span class="p">,</span> <span class="p">...),</span>
<span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;Decentralized Park&quot;</span><span class="p">,</span> <span class="mi">29265</span><span class="p">,</span> <span class="s2">&quot;POLYGON((....))&quot;</span><span class="p">,</span> <span class="p">...),</span>
<span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;Axiom Township&quot;</span><span class="p">,</span> <span class="mi">845696</span><span class="p">,</span> <span class="s2">&quot;POLYGON((....))&quot;</span><span class="p">,</span> <span class="p">...)</span>
<span class="p">...</span>

<span class="k">select</span> <span class="n">id</span><span class="p">,</span> <span class="n">name</span> <span class="k">from</span> <span class="n">neighborhoods_columnstore</span> <span class="k">where</span>
<span class="nf">GEOGRAPHY_INTERSECTS</span><span class="p">(</span><span class="s2">&quot;POINT(-73.94990499 40.69150746)&quot;</span><span class="p">,</span> <span class="n">shape</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="special-spatial-tuning-parameters">
<span id="geospatial-tuning"></span><h2>Special Spatial Tuning Parameters<a class="headerlink" href="index.html#special-spatial-tuning-parameters" title="Permalink to this headline">¶</a></h2>
<p>Spatial indices on <tt class="docutils literal"><span class="pre">Geography</span></tt> columns may be given an optional <tt class="docutils literal"><span class="pre">RESOLUTION</span></tt> parameter. You can choose a resolution between 6 and 32. This controls how many pieces the polygons and linestrings are broken up into for indexing. As a general rule, a lower number means less memory consumption, faster inserts &amp; updates, but slower query times. A higher number may increase query performance at a cost of memory and insert performance.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>As with all tuning knobs, these parameters are not magic. Knobs should only be twiddled
if you have a <em>measurable need</em> for more performance and have worked through the tradeoffs
between ingest, computational load and memory consumption.</p>
<p class="last">For example, it may be useful to compare the percentage difference in the number of rows
returned by <a class="reference internal" href="../../ref/functions/GEOGRAPHY_INTERSECTS/index.html"><em>GEOGRAPHY_INTERSECTS</em></a> and <a class="reference internal" href="../../ref/functions/APPROX_GEOGRAPHY_INTERSECTS/index.html"><em>APPROX_GEOGRAPHY_INTERSECTS</em></a>.
This difference is the &#8220;false positive&#8221; rate of the index for a given resolution. For example,
at resolution 16, suppose that 10% more records are returned by the approximate function. At
resolution 8, the rate only grows to 11%. In that case you should be able to save memory and
increase ingest throughput by using the lower number, without significantly harming query performance.
Again, this kind of tuning is highly dependent on your particular dataset and workload. The
parameters obtained for one application may not apply to another. Your mileage may vary.</p>
</div>
<p>You can also change the resolution of polygons passed into geospatial functions at query time. In this example, the resolution of the &#8220;shape&#8221; column is unchanged, but the POLYGON in the second argument is broken into 16 parts. Each part is queried separately. A lower number will result in fewer index lookup operations, but may return more false positive candidates from the index which are then filtered out of the result set in the second phase of query execution.</p>
<div class="highlight-mysql"><div class="highlight"><pre><span class="k">select</span> <span class="o">*</span>
<span class="k">from</span> <span class="n">neighborhoods</span> <span class="k">with</span> <span class="p">(</span><span class="k">index</span> <span class="o">=</span> <span class="n">shape</span><span class="p">,</span> <span class="n">resolution</span> <span class="o">=</span> <span class="mi">16</span><span class="p">)</span>
<span class="k">where</span> <span class="nf">geography_intersects</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span><span class="s2">&quot;POLYGON(...)&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="using-geojson-data">
<h2>Using GeoJSON Data<a class="headerlink" href="index.html#using-geojson-data" title="Permalink to this headline">¶</a></h2>
<p>MemSQL as of version 4 does not have native GeoJSON support. However, we have generic JSON support as well as computed columns. Combining these features, you can import a subset of GeoJSON data into MemSQL the type system automatically.</p>
<p>For example, given a set of GeoJSON points like this:</p>
<div class="highlight-none"><div class="highlight"><pre>{
  &quot;type&quot;: &quot;Feature&quot;,
  &quot;geometry&quot;: {
    &quot;type&quot;: &quot;Point&quot;,
    &quot;coordinates&quot;: [123.456, 78.901]
  },
  &quot;properties&quot;: {
    &quot;id&quot;: 123456,
    &quot;name&quot;: &quot;Probability Bay Naval Observatory&quot;
  }
}
</pre></div>
</div>
<p>You can construct a table like this:</p>
<div class="highlight-mysql"><div class="highlight"><pre>memsql&gt; create table geostuff (
    -&gt;    id as dataz::properties::%id persisted bigint unsigned,
    -&gt;    name as dataz::properties::$name persisted varchar(128),
    -&gt;    location as geography_point(
    -&gt;      dataz::geometry::coordinates::%`0`,
    -&gt;      dataz::geometry::coordinates::%`1`
    -&gt;    ) persisted geographypoint,
    -&gt;    dataz JSON not null,
    -&gt;    index (location)
    -&gt; );
</pre></div>
</div>
<p>And then insert the JSON string:</p>
<div class="highlight-mysql"><div class="highlight"><pre><span class="n">memsql</span><span class="o">&gt;</span> <span class="k">insert</span> <span class="k">into</span> <span class="nf">geostuff</span> <span class="p">(</span><span class="n">dataz</span><span class="p">)</span> <span class="k">values</span> <span class="p">(</span><span class="s1">&#39;{&quot;type&quot;: &quot;Feature&quot;, &quot;geometry&quot;: {&quot;type&quot;: &quot;Point&quot;,&quot;coordinates&quot;: [123.456, 78.901]},&quot;properties&quot;: {&quot;id&quot;: 123456, &quot;name&quot;: &quot;Probability Bay Naval Observatory&quot; }}&#39;</span><span class="p">);</span>

<span class="n">memsql</span><span class="o">&gt;</span> <span class="k">select</span> <span class="n">id</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">location</span> <span class="k">from</span> <span class="n">geostuff</span><span class="p">;</span>
<span class="o">+--------+-----------------------------------+---------------------------------+</span>
<span class="o">|</span> <span class="n">id</span>     <span class="o">|</span> <span class="n">name</span>                              <span class="o">|</span> <span class="n">location</span>                        <span class="o">|</span>
<span class="o">+--------+-----------------------------------+---------------------------------+</span>
<span class="o">|</span> <span class="mi">123456</span> <span class="o">|</span> <span class="n">Probability</span> <span class="n">Bay</span> <span class="n">Naval</span> <span class="n">Observatory</span> <span class="o">|</span> <span class="nf">POINT</span><span class="p">(</span><span class="mi">123</span><span class="p">.</span><span class="mi">45600012</span> <span class="mi">78</span><span class="p">.</span><span class="mi">90100000</span><span class="p">)</span> <span class="o">|</span>
<span class="o">+--------+-----------------------------------+---------------------------------+</span>
</pre></div>
</div>
<dl class="docutils">
<dt><strong>See Also</strong></dt>
<dd><ul class="first last simple">
<li><a class="reference internal" href="../../ref/functions/index.html#functions-geospatial"><em>MemSQL Geospatial Reference</em></a></li>
</ul>
</dd>
</dl>
</div>
</div>


                    </div>
                    <footer data-swiftype-index="false">
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../../json/json/index.html" class="btn btn-neutral float-right" title="Javascript Object Notation (JSON)">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../columnar/index.html" class="btn btn-neutral" title="Column Store"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>&copy; Copyright 2015, MemSQL</p>
  </div>
</footer>
                </div>
            </div>

        </section>
    </div>

    <script type="text/javascript" src="../../../static_star_theme/js/jquery-2.1.1.min.js"></script>
    <script type="text/javascript" src="../../../static_star_theme/js/underscore-min.js"></script>
    <script type="text/javascript" src="../../../static_star_theme/js/jquery.ba-hashchange.min.js"></script>
    <script type="text/javascript" src="../../../static_star_theme/js/jquery.swiftype.search.js"></script>
    <script type="text/javascript" src="../../../static_star_theme/js/jquery.swiftype.autocomplete.js"></script>
    <script type="text/javascript" src="../../../static_star_theme/js/theme.js"></script>
    <script type="text/javascript" src="../../../static_star_theme/js/search.js"></script> 

        <!-- Google Analytics -->
        <script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-21693588-3', 'auto');
            ga('send', 'pageview');
        </script>
        <!-- End Google Analytics -->

        <script type="text/javascript">
            $.ajax({
                url: document.location.protocol + '//munchkin.marketo.net/munchkin.js',
                dataType: 'script',
                cache: true,
                success: function() {
                    Munchkin.init('759-YLI-316');
                }
            });
        </script>
    </body>
</html>