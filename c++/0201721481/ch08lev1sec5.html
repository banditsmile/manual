<html>
<head>
  <meta name="generator" content="HTML Tidy for Windows (vers 12 April 2005), see www.w3.org">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">

  <title>Section 8.5.  String Streams</title>
  <link rel="STYLESHEET" type="text/css" href="images/style.css" >
  <link rel="STYLESHEET" type="text/css" href="images/docsafari.css" >
</head>

<body>
  <table width="100%" border="0" cellspacing="0" cellpadding="0">
    <tr>
      <td>
        <div style="MARGIN-LEFT: 0.15in;">
          <a href="toc.html" ><img src="images/teamlib.gif"  width="62" height="15" border="0" align="absmiddle" alt="Team LiB"></a>
        </div>
      </td>

      <td align="right">
        <div style="MARGIN-LEFT: 0.15in;">
          <a href="ch08lev1sec4.html" ><img src="images/previous.gif"  width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a> <a href="ch08lev1sec6.html" ><img src="images/next.gif"  width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a>
        </div>
      </td>
    </tr>
  </table><br>

  <table width="100%" border="0" cellspacing="0" cellpadding="0">
    <tr>
      <td valign="top">
        <a name="ch08lev1sec5"></a>

        <h3 class="docSection1Title">8.5. String Streams</h3>
        <h3 class="docSection1Title">8.5. 字符串流</h3>

        <p class="docText">The <tt>iostream</tt> library supports in-memory input/output, in which a stream is attached to a <tt>string</tt> within the program's memory. That <tt>string</tt> can be written to and read from using the <tt>iostream</tt> input and output operators. The library defines three kinds of string streams:</p>
        <p class="docText"><tt>iostream</tt> 标准库支持内存中的输入／输出，只要将流与存储在程序内存中的 <tt>string</tt> 对象捆绑起来即可。此时，可使用 <tt>iostream</tt> 输入和输出操作符读写这个 <tt>string</tt> 对象。标准库定义了三种类型的字符串流：</p>

        <ul>
          <li>
            <p class="docList"><tt>istringstream</tt>, derived from <tt>istream</tt>, reads from a <tt>string</tt>.</p>
            <p class="docList"><tt>istringstream</tt>，由 <tt>istream</tt> 派生而来，提供读 <tt>string</tt> 的功能。</p>
          </li>

          <li>
            <p class="docList"><tt>ostringstream</tt>, derived from <tt>ostream</tt>, writes to a <tt>string</tt>.</p>
            <p class="docList"><tt>ostringstream</tt>，由 <tt>ostream</tt> 派生而来，提供写 <tt>string</tt> 的功能。</p>
          </li>

          <li>
            <p class="docList"><tt>stringstream</tt>, derived from <tt>iostream</tt>, reads and writes a <tt>string</tt>.</p>
            <p class="docList"><tt>stringstream</tt>，由 <tt>iostream</tt> 派生而来，提供读写 <tt>string</tt> 的功能。</p>
          </li>
        </ul>

	<a name="idd1e61529"></a><a name="idd1e61535"></a><a name="idd1e61541"></a><a name="idd1e61549"></a><a name="idd1e61555"></a><a name="idd1e61561"></a><a name="idd1e61569"></a>
        <p class="docText">To use any of these classes, we must include the <tt>sstream</tt> header.</p>
        <p class="docText">要使用上述类，必须包含 <tt>sstream</tt> 头文件。</p>

        <p class="docText">Like the <tt>fstream</tt> types, these types are derived from the <tt>iostream</tt> types, meaning that all the operations on <tt>iostream</tt>s also apply to the types in <tt>sstream</tt>. In addition to the operations that the <tt>sstream</tt> types inherit, these types have a constructor that takes a <tt>string</tt>. The constructor copies the <tt>string</tt> argument into the <tt>stringstream</tt> object. The operations that read and write the <tt>stringstream</tt> read or write the <tt>string</tt> in the object. These classes also define a member named <tt>str</tt> to fetch or set the <tt>string</tt> value that the <tt>stringstream</tt> manipulates.</p>
        <p class="docText">与 <tt>fstream</tt> 类型一样，上述类型由 <tt>iostream</tt> 类型派生而来，这意味着 <tt>iostream</tt> 上所有的操作适用于 <tt>sstream</tt> 中的类型。<tt>sstream</tt> 类型除了继承的操作外，还各自定义了一个有 <tt>string</tt> 形参的构造函数，这个构造函数将 <tt>string</tt> 类型的实参复制给 <tt>stringstream</tt> 对象。对 <tt>stringstream</tt> 的读写操作实际上读写的就是该对象中的 <tt>string</tt> 对象。这些类还定义了名为 <tt>str</tt> 的成员，用来读取或设置 <tt>stringstream</tt> 对象所操纵的 <tt>string</tt> 值。</p>

        <p class="docText">Note that although <tt>fstream</tt> and <tt>sstream</tt> share a common base class, they have no other interrelationship. In particular, we cannot use <tt>open</tt> and <tt>close</tt> on a <tt>stringstream</tt>, nor can we use <tt>str</tt> on an <tt>fstream</tt>.</p>
	<p class="docText">注意到尽管 <tt>fstream</tt> 和 <tt>sstream</tt> 共享相同的基类，但它们没有其他相互关系。特别是，<tt>stringstream</tt> 对象不使用 <tt>open</tt> 和 <tt>close</tt> 函数，而 <tt>fstream</tt> 对象则不允许使用 <tt>str</tt>。</p>
	<a name="ch08table05"></a>

        <h5 class="docTableTitle">Table 8.5. <tt>stringstream</tt>-Specific Operations</h5>
        <h5 class="docTableTitle">表 8.5. <tt>stringstream</tt> 特定的操作</h5>

        <table cellspacing="0" class="allBorders" border="1" rules="none" cellpadding="5">
          <colgroup>
            <col width="200">
            <col width="325">
          </colgroup>

          <tr>
            <td class="docTableCell" align="left" valign="top">
              <p class="docText"><tt>stringstream strm;</tt></p>
            </td>

            <td class="docTableCell" align="left" valign="top">
              <p class="docText">Creates an unbound <tt>stringstream</tt>.</p>
              <p class="docText">创建自由的 <tt>stringstream</tt> 对象</p>
            </td>
          </tr>

          <tr>
            <td class="docTableCell" align="left" valign="top">
              <p class="docText"><tt>stringstream strm(s);</tt></p>
            </td>

            <td class="docTableCell" align="left" valign="top">
              <p class="docText">Creates a <tt>stringstream</tt> that holds a copy of the <tt>string s</tt>.</p>
              <p class="docText">创建存储 s 的副本的 <tt>stringstream</tt> 对象，其中 s 是 <tt>string</tt> 类型的对象</p>
            </td>
          </tr>

          <tr>
            <td class="docTableCell" align="left" valign="top">
              <p class="docText"><tt>strm.str()</tt></p>
            </td>

            <td class="docTableCell" align="left" valign="top">
              <p class="docText">Returns a copy of the <tt>string</tt> that <tt>strm</tt> holds.</p>
              <p class="docText">返回 <tt>strm</tt> 中存储的 <tt>string</tt> 类型对象</p>
            </td>
          </tr>

          <tr>
            <td class="docTableCell" align="left" valign="top">
              <p class="docText"><tt>strm.str(s)</tt></p>
            </td>

            <td class="docTableCell" align="left" valign="top">
              <p class="docText">Copies the <tt>string s</tt> into <tt>strm</tt>. Returns <tt>void</tt>.</p>
              <p class="docText">将 <tt>string</tt> 类型的 s 复制给 <tt>strm</tt>，返回 <tt>void</tt></p>
            </td>
          </tr>
        </table><br>
        <a name="ch08lev2sec13"></a>

        <h4 class="docSection2Title">Using a <tt>stringstream</tt></h4>
        <h4 class="docSection2Title"><tt>stringstream</tt> 对象的和使用</h4>

        <p class="docText">We've seen programs that need to deal with their input a word at a time or a line at a time. The first sort of programs use the <tt>string</tt> input operator and the second use the <tt>getline</tt> function. However, some programs need to do both: They have some processing to do on a per-line basis and other work that needs to be done on each word within each line. Using <tt>stringstreams</tt>lets us do so:</p>
        <p class="docText">前面已经见过以每次一个单词或每次一行的方式处理输入的程序。第一种程序用 <tt>string</tt> 输入操作符，而第二种则使用 <tt>getline</tt> 函数。然而，有些程序需要同时使用这两种方式：有些处理基于每行实现，而其他处理则要操纵每行中每个单词。可用 <tt>stringstreams</tt> 对象实现：</p>
        <pre>
    string line, word;      // <span class="docEmphItalicAlt">will hold a line and word from input, respectively</span>
    while (getline(cin, line))   {            // <span class="docEmphItalicAlt">read a line from the input into</span> <span class="docEmphasis">line</span>
       // <span class="docEmphItalicAlt">do per-line processing</span>
       istringstream stream(line);            // <span class="docEmphItalicAlt">bind to</span> <span class="docEmphasis">stream</span> <span class="docEmphItalicAlt">to the</span> <span class="docEmphasis">line</span> <span class="docEmphItalicAlt">we read</span>
       while (stream &gt;&gt; word){          // <span class="docEmphItalicAlt">read a word from</span> <span class="docEmphasis">line</span>
           // <span class="docEmphItalicAlt">do per-word processing</span>
       }
    }
</pre><br>

        <p class="docText">Here we use <tt>getline</tt> to get an entire line from the input. To get the words in each line, we bind an <tt>istringstream</tt> to the line that we read. We can then use the normal <tt>string</tt> input operator to read the words from each line.</p>
	<p class="docText">这里，使用 <tt>getline</tt> 函数从输入读取整行内容。然后为了获得每行中的单词，将一个 <tt>istringstream</tt> 对象与所读取的行绑定起来，这样只需要使用普通的 <tt>string</tt> 输入操作符即可读出每行中的单词。</p>
	
	<a name="ch08lev2sec14"></a>
        <h4 class="docSection2Title"><tt>stringstream</tt>s Provide Conversions and/or Formatting</h4>
        <h4 class="docSection2Title"><tt>stringstream</tt> 提供的转换和／或格式化</h4>

        <p class="docText">One common use of <tt>stringstream</tt>s is when we want to obtain automatic formatting across multiple data types. For example, we might have a collection of numeric values but want their <tt>string</tt> representation or vice versa. The <tt>sstream</tt> input and output operations automatically convert an arithmetic type into its corresponding <tt>string</tt> representation or back again:</p>
        <p class="docText"><tt>stringstream</tt> 对象的一个常见用法是，需要在多种数据类型之间实现自动格式化时使用该类类型。例如，有一个数值型数据集合，要获取它们的 <tt>string</tt> 表示形式，或反之。<tt>sstream</tt> 输入和输出操作可自动地把算术类型转化为相应的 <tt>string</tt> 表示形式，反过来也可以。</p>
        <pre>
    int val1 = 512, val2 = 1024;
    ostringstream format_message;
    // <span class="docEmphItalicAlt">ok: converts values to a</span> <span class="docEmphasis">string</span> <span class="docEmphItalicAlt">representation</span>
    format_message &lt;&lt; "val1: " &lt;&lt; val1 &lt;&lt; "\n"
                   &lt;&lt; "val2: " &lt;&lt; val2 &lt;&lt; "\n";
</pre><br>

	<a name="idd1e61846"></a><a name="idd1e61853"></a><a name="idd1e61860"></a><a name="idd1e61867"></a><a name="idd1e61871"></a>
        <p class="docText">Here we create an empty <tt>ostringstream</tt> object named <tt>format_message</tt> and insert the indicated text into that object. What's important is that the <tt>int</tt> values are automatically converted to their printable <tt>string</tt> equivalents. The contents of <tt>format_message</tt> are the characters</p>
        <p class="docText">这里创建了一个名为 <tt>format_message</tt> 的 <tt>ostringstream</tt> 类型空对象，并将指定的内容插入该对象。重点在于 <tt>int</tt> 型值自动转换为等价的可打印的字符串。<tt>format_message</tt> 的内容是以下字符：</p>
        <pre>
<span class="docEmphStrong">val1: 512\nval2: 1024</span>
</pre><br>

        <p class="docText">We could retrieve the numeric value by using an <tt>istringstream</tt> to read from the <tt>string</tt>. Reading an <tt>istringstream</tt> automatically converts from the character representation of a numeric value to its corresponding arithmetic value:</p>
        <p class="docText">相反，用 <tt>istringstream</tt> 读 <tt>string</tt> 对象，即可重新将数值型数据找回来。读取 <tt>istringstream</tt> 对象自动地将数值型数据的字符表示方式转换为相应的算术值。</p>
        <pre>
   // <span class="docEmphasis">str</span> <span class="docEmphItalicAlt">member obtains the</span> <span class="docEmphasis">string</span> <span class="docEmphItalicAlt">associated with a</span> <span class="docEmphasis">stringstream</span>
   istringstream input_istring(format_message.str());
   string dump; // <span class="docEmphItalicAlt">place to dump the labels from the formatted message</span>
   // <span class="docEmphItalicAlt">extracts the stored ascii values, converting back to arithmetic types</span>
   input_istring &gt;&gt; dump &gt;&gt; val1 &gt;&gt; dump &gt;&gt; val2;
   cout &lt;&lt; val1 &lt;&lt; " " &lt;&lt; val2 &lt;&lt; endl;  // <span class="docEmphItalicAlt">prints 512 1024</span>
</pre><br>

        <p class="docText">Here we use the <tt>str</tt> member to obtain a copy of the <tt>string</tt> associated with the <tt>ostringstream</tt> we previously created. We bind <tt>input_istring</tt> to that <tt>string</tt>. When we read <tt>input_istring</tt>, the values are converted back to their original numeric representations.</p>
        <p class="docText">这里使用 。<tt>str</tt> 成员获取与之前创建的 <tt>ostringstream</tt> 对象关联的 <tt>string</tt> 副本。再将 <tt>input_istring</tt> 与 <tt>string</tt> 绑定起来。在读 <tt>input_istring</tt> 时，相应的值恢复为它们原来的数值型表示形式</p><a name="ch08note05"></a>

        <div class="docNote">
          <table width="90%" border="0" cellspacing="0" cellpadding="1">
            <tr>
              <td width="60" valign="top"><img border="0" alt="" align="LEFT" width="50" height="54" src="http://shouce.jb51.net/c++/0201721481/images/0201721481/graphics/note.jpg;400478" ></td>

              <td valign="top">
                <p class="docText">To read <tt>input_string</tt>, we must parse the <tt>string</tt> into its component parts. We want the numeric values; to get them we must read (and ignore) the labels that are interspersed with the data we want.</p>
                <p class="docText">为了读取 <tt>input_string</tt>，必须把该 <tt>string</tt> 对象分解为若干个部分。我们要的是数值型数据；为了得到它们，必须读取（和忽略）处于所需数据周围的标号。</p>
              </td>
            </tr>
          </table><br>
        </div><br>

        <p class="docText">Because the input operator reads typed values, it is essential that the types of the objects into which we read be compatible with the types of the values read from the <tt>stringstream</tt>. In this case, <tt>input_istring</tt> had four components: The <tt>string</tt> value <tt>val1:</tt> followed by <tt>512</tt> followed by the <tt>string val2:</tt> followed by <tt>1024</tt>. As usual, whenweread <tt>strings</tt> using the input operator, whitespace is ignored. Thus, when we read the <tt>string</tt> associated with <tt>format_message</tt>, we can ignore the newlines that are part of that value.</p>
	<p class="docText">因为输入操作符读取的是有类型的值，因此读入的对象类型必须和由 <tt>stringstream</tt> 读入的值的类型一致。在本例中，<tt>input_istring</tt> 分成四个部分：<tt>string</tt> 类型的值 <tt>val1</tt>，接着是 <tt>512</tt>，然后是 <tt>string</tt> 类型的值 <tt>val2</tt>，最后是 <tt>1024</tt>。一般情况下，使用输入操作符读 <tt>string</tt> 时，空白符将会忽略。于是，在读与 <tt>format_message</tt> 关联的 <tt>string</tt> 时，忽略其中的换行符。</p>
	
	<a name="ch08sb07"></a>
        <table cellspacing="0" width="90%" border="1" cellpadding="5">
          <tr>
            <td>
              <h2 class="docSidebarTitle">Exercises Section 8.5</h2>

              <blockquote>
                <table border="0" cellspacing="16" cellpadding="0">
                  <tr valign="top">
                    <td align="right" class="docText" width="50"><a name="ch08qa5q1"></a><b>Exercise 8.15:</b></td>

                    <td>
                      <p class="docText">Use the function you wrote for the first exercise in <a class="docLink" href="ch08lev1sec2.html#ch08lev1sec2" >Section 8.2</a> (p. <a class="docLink" href="ch08lev1sec2.html#ch08lev1sec2" >291</a>) to print the contents of an <tt>istringstream</tt> object.</p>
                      <p class="docText">使用<a class="docLink" href="ch08lev1sec2.html#ch08lev1sec2" >第 8.2 节</a>第一个习题编写的函数输出 <tt>istringstream</tt> 对象的内容。</p>
                    </td>
                  </tr>

                  <tr valign="top">
                    <td align="right" class="docText" width="50"><a name="ch08qa5q2"></a><b>Exercise 8.16:</b></td>

                    <td>
                      <p class="docText">Write a program to store each line from a file in a <tt>vector&lt;string&gt;</tt>. Now use an <tt>istringstream</tt> to read each line from the <tt>vector</tt> a word at a time.</p>
                      <p class="docText">编写程序将文件中的每一行存储在 <tt>vector&lt;string&gt;</tt> 容器对象中，然后使用 <tt>istringstream</tt> 从 <tt>vector</tt> 里以每次读一个单词的形式读取存储的行。</p>
                    </td>
                  </tr>
                </table>
              </blockquote>
            </td>
          </tr>
        </table><br>
        <a href="21001535.html" ><img src="images/pixel.gif"  alt="" width="1" height="1" border="0"></a>
      </td>
    </tr>
  </table>

  <table width="100%" border="0" cellspacing="0" cellpadding="0">
    <tr>
      <td>
        <div style="MARGIN-LEFT: 0.15in;">
          <a href="toc.html" ><img src="images/teamlib.gif"  width="62" height="15" border="0" align="absmiddle" alt="Team LiB"></a>
        </div>
      </td>

      <td align="right">
        <div style="MARGIN-LEFT: 0.15in;">
          <a href="ch08lev1sec4.html" ><img src="images/previous.gif"  width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a> <a href="ch08lev1sec6.html" ><img src="images/next.gif"  width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a>
        </div>
      </td>
    </tr>
  </table>
</body>
</html>
