<html>
<head>
  <meta name="generator" content="HTML Tidy for Windows (vers 12 April 2005), see www.w3.org">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">

  <title>Chapter 5.  Expressions</title>
  <link rel="STYLESHEET" type="text/css" href="images/style.css" >
  <link rel="STYLESHEET" type="text/css" href="images/docsafari.css" >
</head>

<body>
  <table width="100%" border="0" cellspacing="0" cellpadding="0">
    <tr>
      <td>
        <div style="MARGIN-LEFT: 0.15in;">
          <a href="toc.html" ><img src="images/teamlib.gif"  width="62" height="15" border="0" align="absmiddle" alt="Team LiB"></a>
        </div>
      </td>

      <td align="right">
        <div style="MARGIN-LEFT: 0.15in;">
          <a href="ch04lev1sec6.html" ><img src="images/previous.gif"  width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a> <a href="ch05lev1sec1.html" ><img src="images/next.gif"  width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a>
        </div>
      </td>
    </tr>
  </table><br>

  <table width="100%" border="0" cellspacing="0" cellpadding="0">
    <tr>
      <td valign="top">
        <a name="ch05"></a>

        <h2 class="docChapterTitle">Chapter 5. Expressions</h2>
        <h2 class="docChapterTitle">第五章 表达式</h2>

        <p class="docText"><span class="docEmphStrong">C<span class="docEmphSmaller">ONTENTS</span></span></p>

        <table cellspacing="0" frame="void" rules="none" cellpadding="5">
          <colgroup>
            <col width="375">
            <col width="100">
          </colgroup>

          <tr>
            <td class="docTableCell" align="left" valign="top">
              <p class="docText"><span class="docEmphStrong"><a class="docLink" href="ch05lev1sec1.html#ch05lev1sec1" >Section 5.1</a></span> <span class="docEmphStrong">Arithmetic Operators</span></p>
            </td>

            <td class="docTableCell" align="right" valign="top">
              <p class="docText"><span class="docEmphStrong"><a class="docLink" href="ch05lev1sec1.html#ch05lev1sec1" >149</a></span></p>
            </td>
          </tr>

          <tr>
            <td class="docTableCell" align="left" valign="top">
              <p class="docText"><span class="docEmphStrong"><a class="docLink" href="ch05lev1sec2.html#ch05lev1sec2" >Section 5.2</a></span> <span class="docEmphStrong">Relational and Logical Operators</span></p>
            </td>

            <td class="docTableCell" align="right" valign="top">
              <p class="docText"><span class="docEmphStrong"><a class="docLink" href="ch05lev1sec2.html#ch05lev1sec2" >152</a></span></p>
            </td>
          </tr>

          <tr>
            <td class="docTableCell" align="left" valign="top">
              <p class="docText"><span class="docEmphStrong"><a class="docLink" href="ch05lev1sec3.html#ch05lev1sec3" >Section 5.3</a></span> <span class="docEmphStrong">The Bitwise Operators</span></p>
            </td>

            <td class="docTableCell" align="right" valign="top">
              <p class="docText"><span class="docEmphStrong"><a class="docLink" href="ch05lev1sec3.html#ch05lev1sec3" >154</a></span></p>
            </td>
          </tr>

          <tr>
            <td class="docTableCell" align="left" valign="top">
              <p class="docText"><span class="docEmphStrong"><a class="docLink" href="ch05lev1sec4.html#ch05lev1sec4" >Section 5.4</a></span> <span class="docEmphStrong">Assignment Operators</span></p>
            </td>

            <td class="docTableCell" align="right" valign="top">
              <p class="docText"><span class="docEmphStrong"><a class="docLink" href="ch05lev1sec4.html#ch05lev1sec4" >159</a></span></p>
            </td>
          </tr>

          <tr>
            <td class="docTableCell" align="left" valign="top">
              <p class="docText"><span class="docEmphStrong"><a class="docLink" href="ch05lev1sec5.html#ch05lev1sec5" >Section 5.5</a></span> <span class="docEmphStrong">Increment and Decrement Operators</span></p>
            </td>

            <td class="docTableCell" align="right" valign="top">
              <p class="docText"><span class="docEmphStrong"><a class="docLink" href="ch05lev1sec5.html#ch05lev1sec5" >162</a></span></p>
            </td>
          </tr>

          <tr>
            <td class="docTableCell" align="left" valign="top">
              <p class="docText"><span class="docEmphStrong"><a class="docLink" href="ch05lev1sec6.html#ch05lev1sec6" >Section 5.6</a></span> <span class="docEmphStrong">The Arrow Operator</span></p>
            </td>

            <td class="docTableCell" align="right" valign="top">
              <p class="docText"><span class="docEmphStrong"><a class="docLink" href="ch05lev1sec6.html#ch05lev1sec6" >164</a></span></p>
            </td>
          </tr>

          <tr>
            <td class="docTableCell" align="left" valign="top">
              <p class="docText"><span class="docEmphStrong"><a class="docLink" href="ch05lev1sec7.html#ch05lev1sec7" >Section 5.7</a></span> <span class="docEmphStrong">The Conditional Operator</span></p>
            </td>

            <td class="docTableCell" align="right" valign="top">
              <p class="docText"><span class="docEmphStrong"><a class="docLink" href="ch05lev1sec7.html#ch05lev1sec7" >165</a></span></p>
            </td>
          </tr>

          <tr>
            <td class="docTableCell" align="left" valign="top">
              <p class="docText"><span class="docEmphStrong"><a class="docLink" href="ch05lev1sec8.html#ch05lev1sec8" >Section 5.8</a></span> <span class="docEmphStrong">The <tt>sizeof</tt> Operator</span></p>
            </td>

            <td class="docTableCell" align="right" valign="top">
              <p class="docText"><span class="docEmphStrong"><a class="docLink" href="ch05lev1sec8.html#ch05lev1sec8" >167</a></span></p>
            </td>
          </tr>

          <tr>
            <td class="docTableCell" align="left" valign="top">
              <p class="docText"><span class="docEmphStrong"><a class="docLink" href="ch05lev1sec9.html#ch05lev1sec9" >Section 5.9</a></span> <span class="docEmphStrong">Comma Operator</span></p>
            </td>

            <td class="docTableCell" align="right" valign="top">
              <p class="docText"><span class="docEmphStrong"><a class="docLink" href="ch05lev1sec9.html#ch05lev1sec9" >168</a></span></p>
            </td>
          </tr>

          <tr>
            <td class="docTableCell" align="left" valign="top">
              <p class="docText"><span class="docEmphStrong"><a class="docLink" href="ch05lev1sec10.html#ch05lev1sec10" >Section 5.10</a></span> <span class="docEmphStrong">Evaluating Compound Expressions</span></p>
            </td>

            <td class="docTableCell" align="right" valign="top">
              <p class="docText"><span class="docEmphStrong"><a class="docLink" href="ch05lev1sec10.html#ch05lev1sec10" >168</a></span></p>
            </td>
          </tr>

          <tr>
            <td class="docTableCell" align="left" valign="top">
              <p class="docText"><span class="docEmphStrong"><a class="docLink" href="ch05lev1sec11.html#ch05lev1sec11" >Section 5.11</a></span> <span class="docEmphStrong">The <tt>new</tt> and <tt>delete</tt> Expressions</span></p>
            </td>

            <td class="docTableCell" align="right" valign="top">
              <p class="docText"><span class="docEmphStrong"><a class="docLink" href="ch05lev1sec11.html#ch05lev1sec11" >174</a></span></p>
            </td>
          </tr>

          <tr>
            <td class="docTableCell" align="left" valign="top">
              <p class="docText"><span class="docEmphStrong"><a class="docLink" href="ch05lev1sec12.html#ch05lev1sec12" >Section 5.12</a></span> <span class="docEmphStrong">Type Conversions</span></p>
            </td>

            <td class="docTableCell" align="right" valign="top">
              <p class="docText"><span class="docEmphStrong"><a class="docLink" href="ch05lev1sec12.html#ch05lev1sec12" >178</a></span></p>
            </td>
          </tr>

          <tr>
            <td class="docTableCell" align="left" valign="top">
              <p class="docText"><span class="docEmphStrong"><a class="docLink" href="ch05lev1sec13.html#ch05lev1sec13" >Chapter Summary</a></span></p>
            </td>

            <td class="docTableCell" align="right" valign="top">
              <p class="docText"><span class="docEmphStrong"><a class="docLink" href="ch05lev1sec13.html#ch05lev1sec13" >188</a></span></p>
            </td>
          </tr>

          <tr>
            <td class="docTableCell" align="left" valign="top">
              <p class="docText"><span class="docEmphStrong"><a class="docLink" href="ch05lev1sec14.html#ch05lev1sec14" >Defined Terms</a></span></p>
            </td>

            <td class="docTableCell" align="right" valign="top">
              <p class="docText"><span class="docEmphStrong"><a class="docLink" href="ch05lev1sec14.html#ch05lev1sec14" >188</a></span></p>
            </td>
          </tr>
        </table><br>

	<a name="ch05term17"></a>
        <p class="docText">C++ provides a rich set of operators and defines what these operators do when applied to operands of built-in type. It also allows us to define meanings for the operators when applied to class types. This facility, known as <b><a class="docLink" href="ch05lev1sec14.html#gloss05_17" >operator overloading</a></b>, is used by the library to define the operators that apply to the library types.</p>
        <p class="docText">C++ 提供了丰富的操作符，并定义操作数为内置类型时，这些操作符的含义。除此之外，C++ 还支持<b><a class="docLink" href="ch05lev1sec14.html#gloss05_17" >操作符重载</a></b>，允许程序员自定义用于类类型时操作符的含义。标准库正是使用这种功能定义用于库类型的操作符。</p>

        <p class="docText">In this chapter our focus is on the operators as defined in the language and applied to operands of built-in type. We will also look at some of the operators defined by the library. <a class="docLink" href="ch14.html#ch14" >Chapter 14</a> shows how we can define our own overloaded operators.</p>
        <p class="docText">本章重点介绍 C++ 语言定义的操作符，它们使用内置类型的操作数；本章还会介绍一些标准库定义的操作符。<a class="docLink" href="ch14.html#ch14" >第十四章</a>将学习如何定义自己的重载操作符。</p>

	<a name="idd1e30732"></a><a name="idd1e30735"></a><a name="idd1e30738"></a><a name="idd1e30741"></a><a name="idd1e30744"></a><a name="idd1e30749"></a><a name="idd1e30757"></a><a name="idd1e30760"></a>
	<a name="ch05term15"></a><a name="ch05term16"></a><a name="ch05term11"></a>
        <p class="docText"><span class="docEmphasis">An expression</span> is composed of one or more <b><a class="docLink" href="ch05lev1sec14.html#gloss05_15" >operands</a></b> that are combined by <b><a class="docLink" href="ch05lev1sec14.html#gloss05_16" >operators</a></b>. The simplest form of an <b><a class="docLink" href="ch05lev1sec14.html#gloss05_11" >expression</a></b> consists of a single literal constant or variable. More complicated expressions are formed from an operator and one or more operands.</p>
        <p class="docText">表达式由一个或多个<b><a class="docLink" href="ch05lev1sec14.html#gloss05_15" >操作数</a></b>通过<b><a class="docLink" href="ch05lev1sec14.html#gloss05_16" >操作符</a></b>组合而成。最简单的<b><a class="docLink" href="ch05lev1sec14.html#gloss05_11" >表达式</a></b>仅包含一个字面值常量或变量。较复杂的表达式则由操作符以及一个或多个操作数构成。</p>

	<a name="ch05term21"></a>
        <p class="docText">Every expression yields a <b><a class="docLink" href="ch05lev1sec14.html#gloss05_21" >result</a></b>. In the case of an expression with no operator, the result is the operand itself, e.g., a literal constant or a variable. When an object is used in a context that requires a value, then the object is evaluated by fetching the object's value. For example, assuming <tt>ival</tt> is an <tt>int</tt> object,</p>
        <p class="docText">每个表达式都会产生一个<b><a class="docLink" href="ch05lev1sec14.html#gloss05_21" >结果</a></b>。如果表达式中没有操作符，则其结果就是操作数本身（例如，字面值常量或变量）的值。当一个对象用在需要使用其值的地方，则计算该对象的值。例如，假设ival是一个int型对象：</p>
        <pre>
     if (ival)            // <span class="docEmphItalicAlt">evaluate</span> <span class="docEmphasis">ival</span> <span class="docEmphItalicAlt">as a condition</span>
         // ....
</pre><br>

        <p class="docText">we could use <tt>ival</tt> as an expression in the condition of an <tt>if</tt>. The condition succeeds if the value of <tt>ival</tt> is not zero and fails otherwise.</p>
	<p class="docText">上述语句将 <tt>ival</tt> 作为 <tt>if</tt> 语句的条件表达式。当 <tt>ival</tt> 为非零值时， <tt>if</tt> 条件成立；否则条件不成立。</p>

        <p class="docText">The result of expressions that involve operators is determined by applying each operator to its operand(s). Except when noted otherwise, the result of an expression is an rvalue (<a class="docLink" href="ch02lev1sec3.html#ch02lev2sec10" >Section 2.3.1</a>, p. <a class="docLink" href="ch02lev1sec3.html#ch02lev2sec10" >45</a>). We can read the result but cannot assign to it.</p>
        <p class="docText">对于含有操作符的表达式，它的值通过对操作数做指定操作获得。除了特殊用法外，表达式的结果是右值（<a class="docLink" href="ch02lev1sec3.html#ch02lev2sec10" >第 2.3.1 节</a>），可以读取该结果值，但是不允许对它进行赋值。</p>

	<a name="ch05note01"></a>
        <div class="docNote">
          <table width="90%" border="0" cellspacing="0" cellpadding="1">
            <tr>
              <td width="60" valign="top"><img border="0" alt="" id="195131139046" align="LEFT" width="50" height="54" src="http://shouce.jb51.net/c++/0201721481/images/0201721481/graphics/note.jpg;400478" ></td>

              <td valign="top">
                <p class="docText">The meaning of an operatorwhat operation is performed and the type of the resultdepends on the types of its operands.</p>
                <p class="docText">操作符的含义——该操作符执行什么操作以及操作结果的类型——取决于操作数的类型。</p>
              </td>
            </tr>
          </table><br>
        </div><br>

        <p class="docText">Until one knows the type of the operand(s), it is not possible to know what a particular expression means. The expression</p>
        <p class="docText">除非已知道操作数的类型，否则无法确定一个特定表达式的含义。下面的表达式</p>
        <pre>
     i + j
</pre><br>

        <p class="docText">might mean integer addition, concatenation of <tt>string</tt>s, floating-point addition, or something else entirely. How the expression is evaluated depends on the types of <tt>i</tt> and <tt>j</tt>.</p>
	<p class="docText">既可能是整数的加法操作、字符串的串接或者浮点数的加法操作，也完全可能是其他的操作。如何计算该表达式的值，完全取决于 <tt>i</tt> 和 <tt>j</tt> 的数据类型。</p>

	<a name="ch05term23"></a><a name="ch05term27"></a>
        <p class="docText">There are both <span class="docEmphStrong"><span class="docEmphasis">unary</span></span> operators and <span class="docEmphStrong"><span class="docEmphasis">binary</span></span> operators. <b><a class="docLink" href="ch05lev1sec14.html#gloss05_23" >Unary operators</a></b>, such as address-of (<b><a class="docLink" href="ch05lev1sec14.html#gloss05_27" ><span class="docEmphStrong"><tt>&amp;</tt></span></a></b>) and dereference (<tt>*</tt>), act on one operand. Binary operators, such as addition (<tt>+</tt>) and subtraction (<tt>-</tt>), act on two operands. There is also one ternary operator that takes three operands. We'll look at this operator in <a class="docLink" href="ch05lev1sec7.html#ch05lev1sec7" >Section 5.7</a> (p. <a class="docLink" href="ch05lev1sec7.html#ch05lev1sec7" >165</a>).</p>
        <p class="docText">C++提供了<span class="docEmphStrong"><span class="docEmphasis">一元操作符</span></span>和<span class="docEmphStrong"><span class="docEmphasis">二元操作符</span></span>两种操作符。作用在一个操作数上的操作符称为一元操作符，如取地址操作符（<b><a class="docLink" href="ch05lev1sec14.html#gloss05_27" ><span class="docEmphStrong"><tt>&amp;</tt></span></a></b>）和解引用操作符（<tt>*</tt>）；而二元操作符则作用于两个操作数上，如加法操作符(<tt>+</tt>)和减法操作符(<tt>-</tt>)。除此之外，C++ 还提供了一个使用三个操作数的三元操作符（ternary operator），我们将在<a class="docLink" href="ch05lev1sec7.html#ch05lev1sec7" >第 5.7 节</a>介绍它。</p>

        <p class="docText">Some <span class="docEmphasis">symbols</span>, such as <tt>*</tt>, are used to represent both a unary and a binary operator. The <tt>*</tt> symbol is used as the (unary) dereference operator and as the (binary) multiplication operator. The uses of the symbol are independent; it can be helpful to think of them as two different symbols. The context in which an operator symbol is used always determines whether the symbol represents a unary or binary operator.</p>
        <p class="docText">有些符号（<span class="docEmphasis">symbols</span>）既可表示一元操作也可表示二元操作。例如，符号 <tt>*</tt> 既可以作为（一元）解引用操作符，也可以作为（二元）乘法操作符，这两种用法相互独立、各不相关，如果将其视为两个不同的符号可能会更容易理解些。对于这类操作符，需要根据该符号所处的上下文来确定它代表一元操作还是二元操作。</p>

        <p class="docText">Operators impose requirements on the type(s) of their operand(s). The language defines the type requirements for the operators when applied to built-in or compound types. For example, the dereference operator, when applied to an object of built-in type, requires that its operand be a pointer type. Attempting to dereference an object of any other built-in or compound type is an error.</p>
        <p class="docText">操作符对其操作数的类型有要求，如果操作符应用于内置或复合类型的操作数，则由C++语言定义其类型要求。例如，用于内置类型对象的解引用操作符要求其操作数必须是指针类型，对任何其他内置类型或复合类型对象进行解引用将导致错误的产生。</p>

	<a name="idd1e30914"></a><a name="idd1e30917"></a><a name="idd1e30922"></a><a name="idd1e30925"></a>
        <p class="docText">The binary operators, when applied to operands of built-in or compound type, usually require that the operands be the same type, or types that can be converted to a common type. We'll look at conversions in <a class="docLink" href="ch05lev1sec12.html#ch05lev1sec12" >Section 5.12</a> (p. <a class="docLink" href="ch05lev1sec12.html#ch05lev1sec12" >178</a>). Although the rules can be complex, for the most part conversions happen in expected ways. For example, we can convert an integer to floating-point, and vice versa, but we cannot convert a pointer type to floating-point.</p>
        <p class="docText">对于操作数为内置或复合类型的二元操作符，通常要求它的两个操作数具有相同的数据类型，或者其类型可以转换为同一种数据类型。关于类型转换，我们将在<a class="docLink" href="ch05lev1sec12.html#ch05lev1sec12" >第 5.12 节</a>学习。尽管规则可能比较复杂，但大部分的类型转换都可按预期的方式进行。例如，整型可转换为浮点类型，反之亦然，但不能将指针类型转换为浮点类型。</p>

	<a name="ch05term19"></a><a name="ch05term2"></a><a name="ch05term18"></a>
        <p class="docText">Understanding expressions with multiple operators requires understanding operator <b><a class="docLink" href="ch05lev1sec14.html#gloss05_19" ><span class="docEmphasis">precedence</span></a></b>, <b><a class="docLink" href="ch05lev1sec14.html#gloss05_02" ><span class="docEmphasis">associativity</span></a></b>, and the <b><a class="docLink" href="ch05lev1sec14.html#gloss05_18" ><span class="docEmphasis">order of evaluation</span></a></b> of the operands. For example, the expression</p>
        <p class="docText">要理解由多个操作符组成的表达式，必须先理解操作符的<b><a class="docLink" href="ch05lev1sec14.html#gloss05_19" ><span class="docEmphasis">优先级</span></a></b>、<b><a class="docLink" href="ch05lev1sec14.html#gloss05_02" ><span class="docEmphasis">结合性</span></a></b>和操作数的<b><a class="docLink" href="ch05lev1sec14.html#gloss05_18" ><span class="docEmphasis">求值顺序</span></a></b>。例如，表达式</p>
        <pre>
     5 + 10 * 20/2;
</pre>

        <p class="docText">uses addition, multiplication, and division. The result of this expression depends on how the operands are grouped to the operators. For example, the operands to the <tt>*</tt> operator could be <tt>10</tt> and <tt>20</tt>, or <tt>10</tt> and <tt>20/2</tt>, or <tt>15</tt> and <tt>20</tt> or <tt>15</tt> and <tt>20/2</tt>. Associativity and precedence rules specify the grouping of operators and their operands. In C++ this expression evaluates to <tt>105</tt>, which is the result of multiplying <tt>10</tt> and <tt>20</tt>, dividing that result by <tt>2</tt>, and then adding <tt>5</tt>.</p>
	<p class="docText">使用了加法、乘法和除法操作。该表达式的值取决于操作数与操作符如何结合。例如，乘法操作符 <tt>*</tt> 的操作数可以是 <tt>10</tt> 和 <tt>20</tt>，也可以是 <tt>10</tt> 和 <tt>20 /2</tt>，或者 <tt>15</tt> 和 <tt>20</tt> 、 <tt>15</tt> 和 <tt>20/2</tt>。结合性和优先级规则规定了操作数与操作符的结合方式。在 C++ 语言中，该表达式的值应是  <tt>105</tt>，<tt>10</tt> 和 <tt>20</tt> 先做乘法操作，然后其结果除以 <tt>2</tt>，再加 <tt>5</tt> 即为最后结果。</p>

		<p class="docText">Knowing how operands and operators are grouped is not always sufficient to determine the result. It may also be necessary to know in what order the operands to each operator are evaluated. Each operator controls what assumptions, if any, can be made as to the order in which the operands will be evaluatedthat is, whether we can assume that the left-hand operand is always evaluated before the right or not. Most operators do not guarantee a particular order of evaluation. We will cover these topics in <a class="docLink" href="ch05lev1sec10.html#ch05lev1sec10" >Section 5.10</a> (p. <a class="docLink" href="ch05lev1sec10.html#ch05lev1sec10" >168</a>).</p>
        <p class="docText">求解表达式时，仅了解操作数和操作符如何结合是不足够的，还必须清楚操作符上每一个操作数的求值顺序。每个操作符都控制了其假定的求值顺序，即，我们是否可以假定左操作数总是先于右操作数求值。大部分的操作符无法保证某种特定的求值次序，我们将于<a class="docLink" href="ch05lev1sec10.html#ch05lev1sec10" >第 5.10 节</a>讨论这个问题。</p>
      </td>
    </tr>
  </table>

  <table width="100%" border="0" cellspacing="0" cellpadding="0">
    <tr>
      <td>
        <div style="MARGIN-LEFT: 0.15in;">
          <a href="toc.html" ><img src="images/teamlib.gif"  width="62" height="15" border="0" align="absmiddle" alt="Team LiB"></a>
        </div>
      </td>

      <td align="right">
        <div style="MARGIN-LEFT: 0.15in;">
          <a href="ch04lev1sec6.html" ><img src="images/previous.gif"  width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a> <a href="ch05lev1sec1.html" ><img src="images/next.gif"  width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a>
        </div>
      </td>
    </tr>
  </table>
</body>
</html>
