<html>
<head>
  <meta name="generator" content="HTML Tidy for Windows (vers 12 April 2005), see www.w3.org">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">

  <title>Chapter 13.  Copy Control</title>
  <link rel="STYLESHEET" type="text/css" href="images/style.css" >
  <link rel="STYLESHEET" type="text/css" href="images/docsafari.css" >
</head>

<body>
  <table width="100%" border="0" cellspacing="0" cellpadding="0">
    <tr>
      <td>
        <div style="MARGIN-LEFT: 0.15in;">
          <a href="toc.html" ><img src="images/teamlib.gif"  width="62" height="15" border="0" align="absmiddle" alt="Team LiB"></a>
        </div>
      </td>

      <td align="right">
        <div style="MARGIN-LEFT: 0.15in;">
          <a href="ch12lev1sec8.html" ><img src="images/previous.gif"  width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a> <a href="ch13lev1sec1.html" ><img src="images/next.gif"  width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a>
        </div>
      </td>
    </tr>
  </table><br>

  <table width="100%" border="0" cellspacing="0" cellpadding="0">
    <tr>
      <td valign="top">
        <a name="ch13"></a>

        <h2 class="docChapterTitle">Chapter 13. Copy Control</h2>

        <p class="docText"><span class="docEmphStrong">C<span class="docEmphSmaller">ONTENTS</span></span></p>

        <table cellspacing="0" frame="void" rules="none" cellpadding="5">
          <colgroup>
            <col width="375">
            <col width="100">
          </colgroup>

          <tr>
            <td class="docTableCell" align="left" valign="top">
              <p class="docText"><span class="docEmphStrong"><a class="docLink" href="ch13lev1sec1.html#ch13lev1sec1" >Section 13.1</a></span> <span class="docEmphStrong">The Copy Constructor</span></p>
            </td>

            <td class="docTableCell" align="right" valign="top">
              <p class="docText"><span class="docEmphStrong"><a class="docLink" href="ch13lev1sec1.html#ch13lev1sec1" >476</a></span></p>
            </td>
          </tr>

          <tr>
            <td class="docTableCell" align="left" valign="top">
              <p class="docText"><span class="docEmphStrong"><a class="docLink" href="ch13lev1sec2.html#ch13lev1sec2" >Section 13.2</a></span> <span class="docEmphStrong">The Assignment Operator</span></p>
            </td>

            <td class="docTableCell" align="right" valign="top">
              <p class="docText"><span class="docEmphStrong"><a class="docLink" href="ch13lev1sec2.html#ch13lev1sec2" >482</a></span></p>
            </td>
          </tr>

          <tr>
            <td class="docTableCell" align="left" valign="top">
              <p class="docText"><span class="docEmphStrong"><a class="docLink" href="ch13lev1sec3.html#ch13lev1sec3" >Section 13.3</a></span> <span class="docEmphStrong">The Destructor</span></p>
            </td>

            <td class="docTableCell" align="right" valign="top">
              <p class="docText"><span class="docEmphStrong"><a class="docLink" href="ch13lev1sec3.html#ch13lev1sec3" >484</a></span></p>
            </td>
          </tr>

          <tr>
            <td class="docTableCell" align="left" valign="top">
              <p class="docText"><span class="docEmphStrong"><a class="docLink" href="ch13lev1sec4.html#ch13lev1sec4" >Section 13.4</a></span> <span class="docEmphStrong">A Message-Handling Example</span></p>
            </td>

            <td class="docTableCell" align="right" valign="top">
              <p class="docText"><span class="docEmphStrong"><a class="docLink" href="ch13lev1sec4.html#ch13lev1sec4" >486</a></span></p>
            </td>
          </tr>

          <tr>
            <td class="docTableCell" align="left" valign="top">
              <p class="docText"><span class="docEmphStrong"><a class="docLink" href="ch13lev1sec5.html#ch13lev1sec5" >Section 13.5</a></span> <span class="docEmphStrong">Managing Pointer Members</span></p>
            </td>

            <td class="docTableCell" align="right" valign="top">
              <p class="docText"><span class="docEmphStrong"><a class="docLink" href="ch13lev1sec5.html#ch13lev1sec5" >492</a></span></p>
            </td>
          </tr>

          <tr>
            <td class="docTableCell" align="left" valign="top">
              <p class="docText"><span class="docEmphStrong"><a class="docLink" href="ch13lev1sec6.html#ch13lev1sec6" >Chapter Summary</a></span></p>
            </td>

            <td class="docTableCell" align="right" valign="top">
              <p class="docText"><span class="docEmphStrong"><a class="docLink" href="ch13lev1sec6.html#ch13lev1sec6" >502</a></span></p>
            </td>
          </tr>

          <tr>
            <td class="docTableCell" align="left" valign="top">
              <p class="docText"><span class="docEmphStrong"><a class="docLink" href="ch13lev1sec7.html#ch13lev1sec7" >Defined Terms</a></span></p>
            </td>

            <td class="docTableCell" align="right" valign="top">
              <p class="docText"><span class="docEmphStrong"><a class="docLink" href="ch13lev1sec7.html#ch13lev1sec7" >502</a></span></p>
            </td>
          </tr>
        </table><br>

        <p class="docText">Each type, whether a built-in or class type, defines the meaning of a (possibly empty) set of operations on objects of that type. We can add two <tt>int</tt> values, run <tt>size</tt> on a <tt>vector</tt>, and so on. These operations define what can be done with objects of the given type.</p>
        <p class="docText">每种类型，无论是内置类型还是类类型，都对该类型对象的一组（可能为空的）操作的含义进行了定义。比如，我们可以将两个 <tt>int</tt> 值相加，运行 <tt>vector</tt> 对象的 <tt>size</tt> 操作，等等。这些操作定义了用给定类型的对象可以完成什么任务。</p>

        <p class="docText">Each type also defines what happens when objects of the type are created. Initialization of objects of class type is defined by constructors. Types also control what happens when objects of the type are copied, assigned, or destroyed. Classes control these actions through special member functions: the copy constructor, the assignment operator, and the destructor. This chapter covers these operations.</p>
        <p class="docText">每种类型还定义了创建该类型的对象时会发生什么——构造函数定义了该类类型对象的初始化。类型还能控制复制、赋值或撤销该类型的对象时会发生什么——类通过特殊的成员函数：复制构造函数、赋值操作符和析构函数来控制这些行为。本章将介绍这些操作。</p>

	<a name="idd1e98799"></a><a name="idd1e98807"></a><a name="idd1e98814"></a><a name="idd1e98822"></a><a name="idd1e98827"></a><a name="idd1e98832"></a><a name="idd1e98835"></a><a name="idd1e98838"></a><a name="idd1e98841"></a><a name="idd1e98844"></a><a name="idd1e98849"></a>
        <p class="docText"><span class="docEmphasis">When we define a new type,</span> we specifyexplicitly or implicitlywhat happens when objects of that type are copied, assigned, and destroyed. We do so by defining special members: the copy constructor, the assignment operator, and the destructor. If we do not explicitly define the copy constructor or the assignment operator, the compiler will (usually) define them for us.</p>
        <p class="docText">当定义一个新类型的时候，需要显式或隐式地指定复制、赋值和撤销该类型的对象时会发生什么——这是通过定义特殊成员：复制构造函数、赋值操作符和析构函数来达到的。如果没有显式定义复制构造函数或赋值操作符，编译器（通常）会为我们定义。</p>

	<a name="ch13term2"></a>
        <p class="docText">The <b><a class="docLink" href="ch13lev1sec7.html#gloss13_02" >copy constructor</a></b> is a special constructor that has a single parameter that is a (usually <tt>const</tt>) reference to the class type. The copy constructor is used explicitly when we define a new object and initialize it from an object of the same type. It is used implicitly when we pass or return objects of that type to or from functions.</p>
        <p class="docText"><b><a class="docLink" href="ch13lev1sec7.html#gloss13_02" >复制构造函数</a></b>是一种特殊构造函数，具有单个形参，该形参（常用 <tt>const</tt> 修饰）是对该类类型的引用。当定义一个新对象并用一个同类型的对象对它进行初始化时，将显式使用复制构造函数。当将该类型的对象传递给函数或函数返回该类型的对象时，将隐式使用复制构造函数。</p>

	<a name="ch13term4"></a>
        <p class="docText">The <b><a class="docLink" href="ch13lev1sec7.html#gloss13_04" >destructor</a></b> is complementary to the constructors: It is applied automatically when an object goes out of scope or when a dynamically allocated object is deleted. The destructor is used to free resources acquired when the object was constructed or during the lifetime of the object. Regardless of whether a class defines its own destructor, the compiler automatically executes the destructors for the non<tt>static</tt> data members of the class.</p>
        <p class="docText"><b><a class="docLink" href="ch13lev1sec7.html#gloss13_04" >析构函数</a></b>是构造函数的互补：当对象超出作用域或动态分配的对象被删除时，将自动应用析构函数。析构函数可用于释放对象时构造或在对象的生命期中所获取的资源。不管类是否定义了自己的析构函数，编译器都自动执行类中非 <tt>static</tt> 数据成员的析构函数。</p>

	<a name="ch13term1"></a>
        <p class="docText">We'll learn more about operator overloading in the next chapter, but in this chapter we cover the <b><a class="docLink" href="ch13lev1sec7.html#gloss13_01" >assignment operator</a></b>. Like constructors, the assignment operator may be overloaded by specifying different types for the right-hand operand. The version whose right-hand operand is of the class type is special: If we do not write one, the compiler will synthesize one for us.</p>
        <p class="docText">在下一章我们将进一步学习操作符重载，本章中我们先介绍<b><a class="docLink" href="ch13lev1sec7.html#gloss13_01" >赋值操作符</a></b>。与构造函数一样，赋值操作符可以通过指定不同类型的右操作数而重载。右操作数为类类型的版本比较特殊：如果我们没有编写这种版本，编译器将为我们合成一个。</p>

	<a name="ch13term3"></a>
        <p class="docText">Collectively, the copy constructor, assignment operator, and destructor are referred to as <b><a class="docLink" href="ch13lev1sec7.html#gloss13_03" >copy control</a></b>. The compiler automatically implements these operations, but the class may define its own versions.</p>
        <p class="docText">复制构造函数、赋值操作符和析构函数总称为<b><a class="docLink" href="ch13lev1sec7.html#gloss13_03" >复制控制</a></b>。编译器自动实现这些操作，但类也可以定义自己的版本。</p>

	<a name="ch13note01"></a>
        <div class="docNote">
          <table width="90%" border="0" cellspacing="0" cellpadding="1">
            <tr>
              <td width="60" valign="top"><img border="0" alt="" align="LEFT" width="57" height="96" src="http://shouce.jb51.net/c++/0201721481/images/0201721481/graphics/beware.jpg;400478" ></td>

              <td valign="top">
                <p class="docText">Copy control is an essential part of defining any C++ class. Programmers new to C++ are often confused by having to define what happens when objects are copied, assigned, or destroyed. This confusion is compounded because if we do not explicitly define these operations, the compiler defines them for usalthough they might not behave as we intend.</p>
                <p class="docText">复制控制是定义任意 C++ 类必不可少的部分。初学 C++ 的程序员常对必须定义在复制、赋值或撤销对象时发生什么感到困惑。因为如果我们没有显式定义这些操作，编译器将为我们定义它们（尽管它们也许不像我们期望的那样工作），这往往使初学者更加困惑。</p>
              </td>
            </tr>
          </table><br>
        </div><br>

        <p class="docText">Often the compiler-synthesized copy-control functions are finethey do exactly the work that needs to be done. But for some classes, relying on the default definitions leads to disaster. Frequently, the most difficult part of implementing the copy-control operations is recognizing when we need to override the default versions. One especially common case that requires the class to define its own the copy-control members is if the class has a pointer member.</p>
        <p class="docText">通常，编译器合成的复制控制函数是非常精练的——它们只做必需的工作。但对某些类而言，依赖于默认定义会导致灾难。实现复制控制操作最困难的部分，往往在于识别何时需要覆盖默认版本。有一种特别常见的情况需要类定义自己的复制控制成员的：类具有指针成员。</p>
      </td>
    </tr>
  </table>

  <table width="100%" border="0" cellspacing="0" cellpadding="0">
    <tr>
      <td>
        <div style="MARGIN-LEFT: 0.15in;">
          <a href="toc.html" ><img src="images/teamlib.gif"  width="62" height="15" border="0" align="absmiddle" alt="Team LiB"></a>
        </div>
      </td>

      <td align="right">
        <div style="MARGIN-LEFT: 0.15in;">
          <a href="ch12lev1sec8.html" ><img src="images/previous.gif"  width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a> <a href="ch13lev1sec1.html" ><img src="images/next.gif"  width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a>
        </div>
      </td>
    </tr>
  </table>
</body>
</html>
